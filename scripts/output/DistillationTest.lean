/-
Copyright (c) 2025 LeanCert Contributors. All rights reserved.
Released under AGPL-3.0 license as described in the file LICENSE.
Authors: LeanCert Contributors (auto-generated)
-/
import LeanCert.ML.Transformer
import LeanCert.ML.LayerNormAffine

set_option linter.unnecessarySeqFocus false

/-!
# Transformer Distillation Verification

This file verifies bounds for both teacher and student transformers,
demonstrating that the distilled student produces similar outputs.

## Models
- **Teacher**: 2 layers, dim=16, hidden=32
- **Student**: 1 layers, dim=8, hidden=16

## Verification
We compute interval bounds for both models on the input domain [-1, 1]^d
using affine arithmetic for tight LayerNorm bounds.
-/

namespace DistillationTest

open LeanCert.Core
open LeanCert.ML
open LeanCert.ML.Transformer
open IntervalVector

/-! ## Teacher Model -/

open LeanCert.ML
open LeanCert.ML.Transformer
open IntervalVector

/-! ## Layer 1 -/

/-- Pre-FFN LayerNorm -/
def teacherBlock1LN1Gamma : List ℚ := [((5685 : ℚ) / 5782), ((6447 : ℚ) / 6838), ((8083 : ℚ) / 8518), ((6146 : ℚ) / 6141), ((7084 : ℚ) / 6887), ((2335 : ℚ) / 2248), ((3864 : ℚ) / 3947), ((3439 : ℚ) / 3357), ((6098 : ℚ) / 6189), ((3187 : ℚ) / 3241), ((1018 : ℚ) / 1021), ((7673 : ℚ) / 7620), ((7461 : ℚ) / 7648), ((4943 : ℚ) / 5058), ((9504 : ℚ) / 9799), ((8777 : ℚ) / 8696)]
def teacherBlock1LN1Beta : List ℚ := [((127 : ℚ) / 8251), ((212 : ℚ) / 5133), ((278 : ℚ) / 7773), (((-49) : ℚ) / 2433), (((-359) : ℚ) / 7704), ((323 : ℚ) / 8183), (((-191) : ℚ) / 9961), (((-92) : ℚ) / 2135), ((147 : ℚ) / 8815), ((91 : ℚ) / 9342), ((171 : ℚ) / 9967), (((-189) : ℚ) / 9946), (((-1) : ℚ) / 125), ((42 : ℚ) / 5435), (((-167) : ℚ) / 9256), ((34 : ℚ) / 8321)]
def teacherBlock1LN1Epsilon : ℚ := ((1 : ℚ) / 100000)
def teacherBlock1LN1 : LayerNormParams where
  gamma := teacherBlock1LN1Gamma
  beta := teacherBlock1LN1Beta
  epsilon := teacherBlock1LN1Epsilon
  epsilon_pos := by simp only [teacherBlock1LN1Epsilon]; norm_num

/-- Feed-Forward Network -/
def teacherBlock1FFNLinear1Weights : List (List ℚ) := [
  [(((-1) : ℚ) / 13), (((-1069) : ℚ) / 9977), (((-133) : ℚ) / 8196), (((-88) : ℚ) / 1313), (((-238) : ℚ) / 9501), (((-111) : ℚ) / 1319), ((2037 : ℚ) / 9994), (((-257) : ℚ) / 2854), (((-17) : ℚ) / 1509), (((-924) : ℚ) / 5573), (((-279) : ℚ) / 8359), ((2400 : ℚ) / 9547), ((1732 : ℚ) / 8781), (((-12) : ℚ) / 269), ((427 : ℚ) / 6438), ((413 : ℚ) / 5338)],
  [(((-801) : ℚ) / 7852), ((85 : ℚ) / 2003), (((-1143) : ℚ) / 7528), (((-181) : ℚ) / 2440), ((43 : ℚ) / 7473), (((-38) : ℚ) / 143), ((239 : ℚ) / 9419), (((-1231) : ℚ) / 7040), (((-111) : ℚ) / 1781), ((1688 : ℚ) / 8727), (((-272) : ℚ) / 3949), ((20 : ℚ) / 2923), ((306 : ℚ) / 3925), (((-1929) : ℚ) / 7396), (((-1029) : ℚ) / 8572), (((-352) : ℚ) / 7323)],
  [((1153 : ℚ) / 9025), (((-124) : ℚ) / 8373), (((-697) : ℚ) / 4562), ((1491 : ℚ) / 6725), ((19 : ℚ) / 8158), (((-103) : ℚ) / 394), ((28 : ℚ) / 2327), ((379 : ℚ) / 5991), ((131 : ℚ) / 2137), (((-167) : ℚ) / 3821), ((781 : ℚ) / 9733), ((1761 : ℚ) / 7270), ((1981 : ℚ) / 9577), ((166 : ℚ) / 3729), ((444 : ℚ) / 8755), (((-904) : ℚ) / 3635)],
  [(((-972) : ℚ) / 4381), ((389 : ℚ) / 6670), ((45 : ℚ) / 3697), (((-296) : ℚ) / 2493), ((1469 : ℚ) / 6029), (((-713) : ℚ) / 3073), (((-1689) : ℚ) / 7586), ((406 : ℚ) / 9181), (((-758) : ℚ) / 6753), ((216 : ℚ) / 6317), (((-683) : ℚ) / 7581), ((153 : ℚ) / 9031), ((1161 : ℚ) / 7408), (((-692) : ℚ) / 8317), ((217 : ℚ) / 2984), (((-515) : ℚ) / 3259)],
  [(((-269) : ℚ) / 4942), (((-1300) : ℚ) / 8257), (((-1049) : ℚ) / 4478), ((223 : ℚ) / 9227), ((11 : ℚ) / 428), (((-2061) : ℚ) / 7981), ((1955 : ℚ) / 9079), ((1186 : ℚ) / 8805), ((623 : ℚ) / 3697), (((-554) : ℚ) / 5389), (((-49) : ℚ) / 1194), (((-2158) : ℚ) / 9159), (((-161) : ℚ) / 7627), ((318 : ℚ) / 1781), (((-915) : ℚ) / 9338), ((1278 : ℚ) / 8453)],
  [(((-725) : ℚ) / 6257), (((-425) : ℚ) / 5019), (((-1885) : ℚ) / 9299), (((-609) : ℚ) / 7718), ((217 : ℚ) / 7370), ((23 : ℚ) / 3361), (((-549) : ℚ) / 4733), ((559 : ℚ) / 4525), (((-17) : ℚ) / 1135), (((-160) : ℚ) / 1619), (((-41) : ℚ) / 1545), (((-892) : ℚ) / 4979), (((-890) : ℚ) / 9309), ((31 : ℚ) / 1419), (((-231) : ℚ) / 1258), ((363 : ℚ) / 1864)],
  [((350 : ℚ) / 5357), ((155 : ℚ) / 3771), ((787 : ℚ) / 5695), (((-271) : ℚ) / 1665), (((-76) : ℚ) / 5513), (((-10) : ℚ) / 3521), (((-718) : ℚ) / 5449), (((-59) : ℚ) / 3753), (((-473) : ℚ) / 7489), (((-173) : ℚ) / 5715), ((103 : ℚ) / 909), ((111 : ℚ) / 3584), (((-1802) : ℚ) / 9855), (((-281) : ℚ) / 3303), ((1105 : ℚ) / 5417), (((-1915) : ℚ) / 9397)],
  [(((-320) : ℚ) / 7341), (((-1727) : ℚ) / 9062), (((-1159) : ℚ) / 6475), ((643 : ℚ) / 2818), ((1333 : ℚ) / 7420), (((-472) : ℚ) / 4653), ((456 : ℚ) / 7075), ((770 : ℚ) / 8053), (((-67) : ℚ) / 410), (((-357) : ℚ) / 4729), (((-989) : ℚ) / 4276), (((-113) : ℚ) / 913), ((1533 : ℚ) / 8228), (((-1501) : ℚ) / 7667), ((72 : ℚ) / 8299), (((-939) : ℚ) / 6943)],
  [(((-29) : ℚ) / 7565), (((-554) : ℚ) / 2747), (((-945) : ℚ) / 9328), ((854 : ℚ) / 4503), ((1728 : ℚ) / 9797), ((741 : ℚ) / 4951), (((-907) : ℚ) / 9921), ((2168 : ℚ) / 8569), (((-675) : ℚ) / 7186), ((1838 : ℚ) / 9995), ((113 : ℚ) / 853), ((206 : ℚ) / 4227), (((-1456) : ℚ) / 7911), ((1061 : ℚ) / 5264), (((-426) : ℚ) / 6691), ((1405 : ℚ) / 7246)],
  [(((-3) : ℚ) / 679), (((-3) : ℚ) / 3119), ((453 : ℚ) / 5287), ((702 : ℚ) / 4937), (((-1757) : ℚ) / 9682), (((-142) : ℚ) / 703), (((-991) : ℚ) / 8318), (((-2120) : ℚ) / 9193), (((-1363) : ℚ) / 8433), ((8 : ℚ) / 277), (((-425) : ℚ) / 8672), ((398 : ℚ) / 1855), (((-179) : ℚ) / 4852), (((-1297) : ℚ) / 8943), ((1377 : ℚ) / 9379), ((835 : ℚ) / 9053)],
  [(((-106) : ℚ) / 5201), ((179 : ℚ) / 684), (((-1513) : ℚ) / 8924), ((1163 : ℚ) / 9089), ((2221 : ℚ) / 9995), (((-1361) : ℚ) / 8464), ((563 : ℚ) / 9973), ((621 : ℚ) / 8432), (((-969) : ℚ) / 8042), (((-835) : ℚ) / 4396), ((1555 : ℚ) / 9754), (((-1099) : ℚ) / 9836), ((741 : ℚ) / 8093), ((1021 : ℚ) / 6516), (((-150) : ℚ) / 787), (((-112) : ℚ) / 2423)],
  [((1103 : ℚ) / 6550), ((1592 : ℚ) / 9747), ((366 : ℚ) / 6689), (((-133) : ℚ) / 4271), ((101 : ℚ) / 680), (((-127) : ℚ) / 2417), (((-427) : ℚ) / 3468), ((256 : ℚ) / 5445), (((-502) : ℚ) / 3879), (((-311) : ℚ) / 2543), (((-1073) : ℚ) / 5643), (((-63) : ℚ) / 1244), ((93 : ℚ) / 464), (((-1566) : ℚ) / 9217), (((-220) : ℚ) / 5961), (((-20) : ℚ) / 229)],
  [(((-401) : ℚ) / 3063), (((-736) : ℚ) / 8637), (((-404) : ℚ) / 1735), ((103 : ℚ) / 9413), ((161 : ℚ) / 6789), (((-889) : ℚ) / 4133), (((-1525) : ℚ) / 9077), (((-41) : ℚ) / 5874), (((-349) : ℚ) / 5464), (((-419) : ℚ) / 1563), ((492 : ℚ) / 3161), ((340 : ℚ) / 6917), ((649 : ℚ) / 9048), (((-367) : ℚ) / 3692), (((-587) : ℚ) / 3014), ((243 : ℚ) / 7997)],
  [(((-1073) : ℚ) / 7492), (((-871) : ℚ) / 9604), ((995 : ℚ) / 7543), (((-332) : ℚ) / 1775), (((-907) : ℚ) / 4652), ((2207 : ℚ) / 8720), (((-1888) : ℚ) / 9747), (((-319) : ℚ) / 1367), ((1482 : ℚ) / 9889), ((673 : ℚ) / 8548), (((-102) : ℚ) / 467), ((1498 : ℚ) / 9829), (((-985) : ℚ) / 4752), (((-1153) : ℚ) / 9554), ((170 : ℚ) / 2491), ((1417 : ℚ) / 5708)],
  [(((-1143) : ℚ) / 7750), (((-142) : ℚ) / 957), ((403 : ℚ) / 9441), ((192 : ℚ) / 3533), (((-111) : ℚ) / 1015), ((1306 : ℚ) / 6407), ((1405 : ℚ) / 9804), (((-1195) : ℚ) / 8783), (((-291) : ℚ) / 1447), (((-1325) : ℚ) / 8827), (((-1671) : ℚ) / 8702), ((517 : ℚ) / 2969), ((149 : ℚ) / 7905), (((-109) : ℚ) / 700), ((589 : ℚ) / 5315), (((-164) : ℚ) / 2181)],
  [(((-466) : ℚ) / 3789), (((-446) : ℚ) / 5777), ((1196 : ℚ) / 5435), (((-1345) : ℚ) / 7519), ((429 : ℚ) / 4064), ((1075 : ℚ) / 9269), (((-1277) : ℚ) / 5749), ((1351 : ℚ) / 9035), (((-730) : ℚ) / 3279), (((-1083) : ℚ) / 9050), (((-425) : ℚ) / 8366), (((-1356) : ℚ) / 9641), ((102 : ℚ) / 941), (((-881) : ℚ) / 8573), (((-284) : ℚ) / 2117), ((193 : ℚ) / 6081)],
  [((21 : ℚ) / 1009), ((842 : ℚ) / 7089), ((1920 : ℚ) / 9623), (((-492) : ℚ) / 5489), ((1027 : ℚ) / 5162), ((584 : ℚ) / 5025), ((37 : ℚ) / 8409), ((1999 : ℚ) / 9812), (((-149) : ℚ) / 7618), (((-347) : ℚ) / 4046), ((173 : ℚ) / 2079), (((-1399) : ℚ) / 9103), ((727 : ℚ) / 4895), (((-488) : ℚ) / 5961), (((-1058) : ℚ) / 9495), (((-613) : ℚ) / 9058)],
  [((44 : ℚ) / 8241), ((1374 : ℚ) / 9329), ((1693 : ℚ) / 8917), (((-1647) : ℚ) / 7405), ((266 : ℚ) / 3715), ((905 : ℚ) / 7949), ((1 : ℚ) / 1202), (((-667) : ℚ) / 9851), (((-1555) : ℚ) / 7121), ((379 : ℚ) / 1970), (((-686) : ℚ) / 4391), ((798 : ℚ) / 4219), ((175 : ℚ) / 1404), ((575 : ℚ) / 8021), ((1481 : ℚ) / 7011), (((-1052) : ℚ) / 5299)],
  [((313 : ℚ) / 1363), (((-537) : ℚ) / 8227), (((-161) : ℚ) / 1054), ((221 : ℚ) / 3664), ((1939 : ℚ) / 8167), (((-784) : ℚ) / 3107), ((1097 : ℚ) / 6741), ((1228 : ℚ) / 5435), ((1405 : ℚ) / 4969), (((-452) : ℚ) / 8483), (((-11) : ℚ) / 1301), ((1241 : ℚ) / 9778), ((774 : ℚ) / 9071), ((17 : ℚ) / 7087), (((-696) : ℚ) / 4343), (((-200) : ℚ) / 603)],
  [(((-1467) : ℚ) / 8162), ((96 : ℚ) / 775), (((-116) : ℚ) / 1151), ((625 : ℚ) / 9617), (((-57) : ℚ) / 1079), (((-182) : ℚ) / 1593), ((246 : ℚ) / 5423), ((937 : ℚ) / 3576), ((1519 : ℚ) / 6654), ((44 : ℚ) / 303), (((-248) : ℚ) / 3199), ((353 : ℚ) / 6926), ((388 : ℚ) / 9665), (((-1413) : ℚ) / 9427), (((-77) : ℚ) / 508), (((-430) : ℚ) / 5941)],
  [(((-743) : ℚ) / 6245), ((1153 : ℚ) / 7840), ((535 : ℚ) / 3956), ((477 : ℚ) / 6850), ((2689 : ℚ) / 9966), ((1961 : ℚ) / 8395), ((429 : ℚ) / 8951), (((-881) : ℚ) / 4557), (((-656) : ℚ) / 3119), (((-1059) : ℚ) / 4568), ((1081 : ℚ) / 6289), ((529 : ℚ) / 4059), (((-1135) : ℚ) / 4883), ((1913 : ℚ) / 8898), (((-609) : ℚ) / 3232), ((777 : ℚ) / 8878)],
  [((820 : ℚ) / 3737), ((1712 : ℚ) / 9885), (((-154) : ℚ) / 4645), (((-1785) : ℚ) / 9223), ((1743 : ℚ) / 9382), (((-10) : ℚ) / 7461), (((-2085) : ℚ) / 9938), ((233 : ℚ) / 2682), (((-397) : ℚ) / 3188), ((43 : ℚ) / 2424), ((151 : ℚ) / 3980), (((-1801) : ℚ) / 9183), (((-143) : ℚ) / 9593), ((2167 : ℚ) / 8837), (((-1298) : ℚ) / 4589), (((-310) : ℚ) / 3727)],
  [(((-1319) : ℚ) / 9455), ((307 : ℚ) / 3759), ((363 : ℚ) / 2248), (((-1951) : ℚ) / 8824), (((-439) : ℚ) / 7246), (((-901) : ℚ) / 8590), (((-29) : ℚ) / 9233), (((-1593) : ℚ) / 9493), (((-1276) : ℚ) / 7701), ((65 : ℚ) / 1633), ((56 : ℚ) / 6521), ((1083 : ℚ) / 5504), (((-267) : ℚ) / 6686), (((-773) : ℚ) / 6756), (((-81) : ℚ) / 5488), (((-63) : ℚ) / 4636)],
  [(((-145) : ℚ) / 2932), ((194 : ℚ) / 3137), ((1107 : ℚ) / 6050), (((-343) : ℚ) / 2073), (((-2056) : ℚ) / 7387), ((528 : ℚ) / 6001), (((-1167) : ℚ) / 5951), ((178 : ℚ) / 9849), ((529 : ℚ) / 9900), ((1353 : ℚ) / 6850), ((179 : ℚ) / 756), ((927 : ℚ) / 5579), ((112 : ℚ) / 1941), (((-1208) : ℚ) / 6641), (((-226) : ℚ) / 1567), (((-697) : ℚ) / 4791)],
  [((19 : ℚ) / 125), (((-97) : ℚ) / 722), (((-712) : ℚ) / 9605), (((-1657) : ℚ) / 8828), (((-1211) : ℚ) / 9907), (((-815) : ℚ) / 6534), ((33 : ℚ) / 299), (((-527) : ℚ) / 6751), (((-53) : ℚ) / 9568), (((-33) : ℚ) / 149), ((24 : ℚ) / 649), (((-200) : ℚ) / 4693), (((-982) : ℚ) / 4147), ((145 : ℚ) / 3881), (((-2773) : ℚ) / 9954), ((513 : ℚ) / 8098)],
  [((147 : ℚ) / 1919), ((7 : ℚ) / 687), (((-1027) : ℚ) / 8886), ((117 : ℚ) / 649), (((-683) : ℚ) / 5189), (((-251) : ℚ) / 972), (((-61) : ℚ) / 3185), (((-7) : ℚ) / 9574), (((-715) : ℚ) / 4507), ((312 : ℚ) / 7717), ((526 : ℚ) / 4995), ((530 : ℚ) / 2293), ((727 : ℚ) / 5070), (((-561) : ℚ) / 4181), ((420 : ℚ) / 7867), ((1929 : ℚ) / 8366)],
  [(((-165) : ℚ) / 5536), (((-227) : ℚ) / 8183), (((-1559) : ℚ) / 8950), ((1409 : ℚ) / 9303), ((5 : ℚ) / 787), ((216 : ℚ) / 4211), ((34 : ℚ) / 1029), ((109 : ℚ) / 470), ((247 : ℚ) / 1506), (((-2282) : ℚ) / 9301), ((583 : ℚ) / 2496), ((2246 : ℚ) / 9531), (((-403) : ℚ) / 3396), (((-764) : ℚ) / 9309), ((981 : ℚ) / 8756), (((-198) : ℚ) / 9091)],
  [((175 : ℚ) / 8461), (((-63) : ℚ) / 605), ((52 : ℚ) / 2053), ((564 : ℚ) / 8701), (((-2680) : ℚ) / 9721), ((375 : ℚ) / 2057), ((1585 : ℚ) / 7988), (((-879) : ℚ) / 5152), (((-2191) : ℚ) / 8390), ((1011 : ℚ) / 9316), ((559 : ℚ) / 9353), ((205 : ℚ) / 1344), ((1847 : ℚ) / 9767), ((301 : ℚ) / 4376), (((-988) : ℚ) / 9801), ((386 : ℚ) / 5621)],
  [((878 : ℚ) / 8691), ((234 : ℚ) / 2471), ((1346 : ℚ) / 6361), ((909 : ℚ) / 6514), (((-234) : ℚ) / 9703), ((534 : ℚ) / 7013), ((47 : ℚ) / 500), ((1031 : ℚ) / 6122), ((1426 : ℚ) / 6915), (((-1126) : ℚ) / 9869), ((2077 : ℚ) / 9298), (((-309) : ℚ) / 4885), ((738 : ℚ) / 8539), ((256 : ℚ) / 8547), ((665 : ℚ) / 5209), (((-379) : ℚ) / 1946)],
  [((1207 : ℚ) / 5655), (((-1208) : ℚ) / 6535), ((846 : ℚ) / 9119), ((8 : ℚ) / 469), ((753 : ℚ) / 2849), ((1035 : ℚ) / 5293), (((-451) : ℚ) / 5345), ((1850 : ℚ) / 9571), ((780 : ℚ) / 8441), (((-783) : ℚ) / 4130), ((1251 : ℚ) / 6869), ((101 : ℚ) / 5005), (((-209) : ℚ) / 4986), ((245 : ℚ) / 7681), ((70 : ℚ) / 2339), ((181 : ℚ) / 9038)],
  [((355 : ℚ) / 7251), ((711 : ℚ) / 8866), ((29 : ℚ) / 553), (((-497) : ℚ) / 5517), (((-847) : ℚ) / 6464), (((-1249) : ℚ) / 9723), (((-212) : ℚ) / 1031), (((-625) : ℚ) / 4579), ((447 : ℚ) / 7231), (((-971) : ℚ) / 6265), ((534 : ℚ) / 8663), (((-81) : ℚ) / 338), ((1399 : ℚ) / 9457), (((-613) : ℚ) / 9570), ((1031 : ℚ) / 8201), (((-133) : ℚ) / 5913)],
  [(((-1777) : ℚ) / 9117), ((1784 : ℚ) / 8775), (((-451) : ℚ) / 4225), ((1690 : ℚ) / 9339), (((-267) : ℚ) / 8237), (((-1442) : ℚ) / 7949), (((-37) : ℚ) / 5170), (((-9) : ℚ) / 6928), ((325 : ℚ) / 8192), (((-199) : ℚ) / 756), (((-857) : ℚ) / 7904), (((-722) : ℚ) / 8229), ((1024 : ℚ) / 5663), ((4 : ℚ) / 53), ((1371 : ℚ) / 8729), (((-329) : ℚ) / 2153)]
]
def teacherBlock1FFNLinear1Bias : List ℚ := [(((-122) : ℚ) / 597), ((835 : ℚ) / 9401), (((-884) : ℚ) / 4215), (((-345) : ℚ) / 5651), (((-242) : ℚ) / 8755), (((-173) : ℚ) / 1210), ((1261 : ℚ) / 9551), (((-188) : ℚ) / 3183), ((37 : ℚ) / 868), (((-415) : ℚ) / 4251), (((-2269) : ℚ) / 9470), ((143 : ℚ) / 3204), ((127 : ℚ) / 4100), ((1497 : ℚ) / 8155), ((44 : ℚ) / 593), ((1740 : ℚ) / 9899), ((1703 : ℚ) / 7470), ((231 : ℚ) / 2165), (((-539) : ℚ) / 5031), (((-1093) : ℚ) / 9244), (((-281) : ℚ) / 5942), ((110 : ℚ) / 3283), (((-10) : ℚ) / 3347), ((221 : ℚ) / 5492), (((-389) : ℚ) / 6950), ((1364 : ℚ) / 8929), (((-989) : ℚ) / 7603), ((1986 : ℚ) / 9481), (((-785) : ℚ) / 6448), (((-1339) : ℚ) / 8594), ((611 : ℚ) / 2245), ((5 : ℚ) / 4661)]
def teacherBlock1FFNLinear1 : Layer where
  weights := teacherBlock1FFNLinear1Weights
  bias := teacherBlock1FFNLinear1Bias

def teacherBlock1FFNLinear2Weights : List (List ℚ) := [
  [((306 : ℚ) / 6917), ((76 : ℚ) / 733), ((817 : ℚ) / 8275), ((301 : ℚ) / 4377), ((37 : ℚ) / 7362), (((-100) : ℚ) / 8439), (((-190) : ℚ) / 9453), (((-1068) : ℚ) / 7643), ((520 : ℚ) / 5019), (((-147) : ℚ) / 1009), (((-448) : ℚ) / 3889), (((-33) : ℚ) / 755), (((-3) : ℚ) / 184), ((427 : ℚ) / 4791), (((-847) : ℚ) / 5913), ((610 : ℚ) / 3473), (((-65) : ℚ) / 661), ((122 : ℚ) / 8507), (((-1248) : ℚ) / 6841), ((11 : ℚ) / 95), (((-989) : ℚ) / 8869), (((-149) : ℚ) / 6168), ((835 : ℚ) / 7324), ((845 : ℚ) / 6524), (((-244) : ℚ) / 4023), (((-477) : ℚ) / 5269), ((166 : ℚ) / 4635), (((-181) : ℚ) / 5844), (((-35) : ℚ) / 7226), ((133 : ℚ) / 3845), ((143 : ℚ) / 2360), (((-809) : ℚ) / 7269)],
  [((121 : ℚ) / 4819), ((1405 : ℚ) / 9951), ((1857 : ℚ) / 9146), ((480 : ℚ) / 3877), ((298 : ℚ) / 2167), ((891 : ℚ) / 7588), ((37 : ℚ) / 809), ((541 : ℚ) / 3782), ((1275 : ℚ) / 9749), (((-631) : ℚ) / 8958), ((420 : ℚ) / 9383), (((-919) : ℚ) / 7196), ((1469 : ℚ) / 9076), (((-1192) : ℚ) / 6195), ((334 : ℚ) / 9381), (((-1505) : ℚ) / 7698), (((-63) : ℚ) / 9127), ((47 : ℚ) / 1104), (((-111) : ℚ) / 7487), (((-631) : ℚ) / 4679), ((340 : ℚ) / 6211), ((197 : ℚ) / 4485), ((213 : ℚ) / 7120), ((103 : ℚ) / 627), ((998 : ℚ) / 8897), ((306 : ℚ) / 4585), (((-107) : ℚ) / 1708), (((-1423) : ℚ) / 9711), (((-93) : ℚ) / 2134), ((220 : ℚ) / 9469), (((-446) : ℚ) / 2367), ((444 : ℚ) / 9817)],
  [(((-71) : ℚ) / 4426), ((477 : ℚ) / 3019), ((800 : ℚ) / 6827), (((-605) : ℚ) / 8939), (((-711) : ℚ) / 5948), (((-863) : ℚ) / 7976), (((-1007) : ℚ) / 9806), (((-148) : ℚ) / 3241), (((-182) : ℚ) / 9081), (((-37) : ℚ) / 410), ((45 : ℚ) / 494), ((225 : ℚ) / 9704), (((-167) : ℚ) / 1338), ((61 : ℚ) / 1785), ((428 : ℚ) / 7975), ((42 : ℚ) / 2353), (((-53) : ℚ) / 9377), ((876 : ℚ) / 8227), ((419 : ℚ) / 8663), (((-46) : ℚ) / 2131), ((273 : ℚ) / 2851), ((272 : ℚ) / 9561), ((35 : ℚ) / 3534), (((-1228) : ℚ) / 9215), ((239 : ℚ) / 3809), (((-89) : ℚ) / 6504), (((-23) : ℚ) / 370), ((125 : ℚ) / 7727), (((-1573) : ℚ) / 8793), ((275 : ℚ) / 7193), (((-251) : ℚ) / 2897), ((787 : ℚ) / 6293)],
  [((253 : ℚ) / 3760), (((-258) : ℚ) / 9475), (((-491) : ℚ) / 9297), (((-61) : ℚ) / 2669), ((713 : ℚ) / 5993), (((-259) : ℚ) / 3950), (((-871) : ℚ) / 9835), (((-310) : ℚ) / 2291), ((1173 : ℚ) / 9014), (((-548) : ℚ) / 5179), (((-1654) : ℚ) / 9733), ((653 : ℚ) / 5759), ((191 : ℚ) / 9958), ((770 : ℚ) / 9979), (((-1032) : ℚ) / 8243), (((-333) : ℚ) / 3611), ((83 : ℚ) / 657), ((877 : ℚ) / 7412), (((-22) : ℚ) / 3133), ((957 : ℚ) / 9980), ((16 : ℚ) / 103), (((-267) : ℚ) / 3794), (((-41) : ℚ) / 5572), ((1562 : ℚ) / 9773), (((-1369) : ℚ) / 8048), (((-260) : ℚ) / 8367), (((-607) : ℚ) / 5549), (((-219) : ℚ) / 2509), (((-769) : ℚ) / 7607), (((-1583) : ℚ) / 8495), (((-222) : ℚ) / 7375), ((214 : ℚ) / 9047)],
  [((115 : ℚ) / 2686), ((798 : ℚ) / 5749), (((-1326) : ℚ) / 8507), (((-844) : ℚ) / 9475), ((97 : ℚ) / 3868), (((-571) : ℚ) / 7308), ((17 : ℚ) / 9776), (((-591) : ℚ) / 4051), ((725 : ℚ) / 7893), (((-1269) : ℚ) / 8117), (((-63) : ℚ) / 6299), ((1427 : ℚ) / 9889), (((-511) : ℚ) / 4523), (((-16) : ℚ) / 239), (((-844) : ℚ) / 9639), ((397 : ℚ) / 9747), (((-113) : ℚ) / 2434), (((-545) : ℚ) / 3362), (((-1012) : ℚ) / 7401), (((-137) : ℚ) / 3127), ((1339 : ℚ) / 8548), ((3 : ℚ) / 4013), (((-928) : ℚ) / 9759), ((1391 : ℚ) / 9998), ((956 : ℚ) / 7529), (((-171) : ℚ) / 2531), (((-919) : ℚ) / 5578), (((-715) : ℚ) / 8599), ((673 : ℚ) / 5011), ((1136 : ℚ) / 8703), ((39 : ℚ) / 547), ((430 : ℚ) / 7163)],
  [(((-1157) : ℚ) / 8085), ((378 : ℚ) / 6107), ((881 : ℚ) / 8592), (((-455) : ℚ) / 3502), ((1427 : ℚ) / 7291), (((-868) : ℚ) / 8065), ((817 : ℚ) / 6670), ((1081 : ℚ) / 7327), (((-388) : ℚ) / 8415), (((-631) : ℚ) / 5720), (((-993) : ℚ) / 5240), ((313 : ℚ) / 3355), (((-679) : ℚ) / 7093), ((1182 : ℚ) / 9091), (((-277) : ℚ) / 8934), (((-1309) : ℚ) / 9712), ((861 : ℚ) / 6638), ((467 : ℚ) / 3310), (((-1441) : ℚ) / 8233), (((-7) : ℚ) / 1231), ((239 : ℚ) / 8122), (((-1087) : ℚ) / 8066), (((-1491) : ℚ) / 9370), ((1021 : ℚ) / 6385), (((-705) : ℚ) / 6089), ((15 : ℚ) / 224), ((153 : ℚ) / 1537), ((589 : ℚ) / 6214), (((-22) : ℚ) / 399), ((779 : ℚ) / 5550), ((269 : ℚ) / 9533), ((469 : ℚ) / 4282)],
  [(((-229) : ℚ) / 9961), (((-1388) : ℚ) / 8507), (((-28) : ℚ) / 6917), ((1378 : ℚ) / 9961), ((319 : ℚ) / 3838), ((26 : ℚ) / 591), ((827 : ℚ) / 9950), ((377 : ℚ) / 4348), ((109 : ℚ) / 9832), (((-98) : ℚ) / 1075), ((61 : ℚ) / 1370), (((-165) : ℚ) / 9626), (((-289) : ℚ) / 6006), (((-139) : ℚ) / 1158), ((1114 : ℚ) / 7611), ((959 : ℚ) / 9649), (((-807) : ℚ) / 6188), (((-1467) : ℚ) / 8788), ((809 : ℚ) / 8014), ((134 : ℚ) / 3225), ((622 : ℚ) / 5811), (((-239) : ℚ) / 9284), ((457 : ℚ) / 7870), (((-1) : ℚ) / 18), (((-614) : ℚ) / 9269), ((236 : ℚ) / 8121), (((-307) : ℚ) / 9978), ((96 : ℚ) / 2615), ((2 : ℚ) / 6703), ((765 : ℚ) / 4967), ((233 : ℚ) / 4379), (((-146) : ℚ) / 4295)],
  [((121 : ℚ) / 2749), (((-1453) : ℚ) / 8255), (((-108) : ℚ) / 1801), (((-2105) : ℚ) / 8079), (((-1240) : ℚ) / 9049), (((-770) : ℚ) / 7239), ((637 : ℚ) / 4777), (((-1396) : ℚ) / 9141), (((-124) : ℚ) / 7389), (((-561) : ℚ) / 3533), (((-1605) : ℚ) / 7489), (((-1399) : ℚ) / 8493), (((-374) : ℚ) / 5761), (((-685) : ℚ) / 9861), ((91 : ℚ) / 1535), ((826 : ℚ) / 8861), ((1161 : ℚ) / 8320), ((169 : ℚ) / 1551), (((-842) : ℚ) / 4745), ((1041 : ℚ) / 6616), (((-13) : ℚ) / 2551), ((1061 : ℚ) / 9915), (((-139) : ℚ) / 9148), (((-147) : ℚ) / 6235), (((-1403) : ℚ) / 7868), (((-893) : ℚ) / 9942), ((17 : ℚ) / 5978), ((823 : ℚ) / 9066), ((375 : ℚ) / 3994), ((503 : ℚ) / 7185), ((1612 : ℚ) / 9461), (((-1528) : ℚ) / 9615)],
  [((512 : ℚ) / 8845), ((627 : ℚ) / 7207), (((-445) : ℚ) / 7971), (((-1351) : ℚ) / 9593), ((303 : ℚ) / 5437), ((255 : ℚ) / 4511), ((151 : ℚ) / 9262), ((826 : ℚ) / 4663), ((269 : ℚ) / 7471), (((-908) : ℚ) / 7315), (((-1093) : ℚ) / 9472), ((1097 : ℚ) / 9916), ((705 : ℚ) / 6191), (((-698) : ℚ) / 4223), ((974 : ℚ) / 9991), (((-396) : ℚ) / 8513), ((131 : ℚ) / 3004), ((17 : ℚ) / 1722), ((1303 : ℚ) / 8710), (((-167) : ℚ) / 3714), ((626 : ℚ) / 8191), ((147 : ℚ) / 8138), ((499 : ℚ) / 6060), (((-929) : ℚ) / 8767), (((-493) : ℚ) / 9278), (((-573) : ℚ) / 4436), (((-559) : ℚ) / 3914), ((1 : ℚ) / 34), (((-950) : ℚ) / 8691), (((-577) : ℚ) / 3881), ((158 : ℚ) / 3015), (((-231) : ℚ) / 3820)],
  [((891 : ℚ) / 7592), ((1199 : ℚ) / 9089), ((1062 : ℚ) / 7511), ((521 : ℚ) / 3933), (((-314) : ℚ) / 9595), (((-149) : ℚ) / 9349), ((293 : ℚ) / 2910), (((-656) : ℚ) / 5537), (((-20) : ℚ) / 983), ((746 : ℚ) / 8125), ((335 : ℚ) / 2917), ((141 : ℚ) / 5678), (((-332) : ℚ) / 3611), ((1445 : ℚ) / 9042), (((-1) : ℚ) / 1282), ((6 : ℚ) / 8395), ((1007 : ℚ) / 7805), ((527 : ℚ) / 4358), ((600 : ℚ) / 4789), ((306 : ℚ) / 6497), (((-93) : ℚ) / 817), ((489 : ℚ) / 2939), (((-379) : ℚ) / 2277), (((-1063) : ℚ) / 7467), ((1004 : ℚ) / 6773), (((-18) : ℚ) / 137), (((-3) : ℚ) / 538), (((-32) : ℚ) / 9097), (((-1458) : ℚ) / 7637), (((-1227) : ℚ) / 7030), ((603 : ℚ) / 4342), (((-55) : ℚ) / 7028)],
  [((979 : ℚ) / 8831), (((-212) : ℚ) / 5109), (((-370) : ℚ) / 4367), ((415 : ℚ) / 2176), (((-273) : ℚ) / 9733), (((-18) : ℚ) / 121), ((97 : ℚ) / 8114), ((326 : ℚ) / 3223), ((94 : ℚ) / 1379), ((1221 : ℚ) / 7082), ((1318 : ℚ) / 9715), ((155 : ℚ) / 2363), (((-1067) : ℚ) / 9019), ((227 : ℚ) / 9294), (((-1577) : ℚ) / 8971), (((-44) : ℚ) / 1069), (((-549) : ℚ) / 5746), ((838 : ℚ) / 9077), ((904 : ℚ) / 9101), (((-607) : ℚ) / 9468), ((104 : ℚ) / 4285), ((1724 : ℚ) / 9145), ((793 : ℚ) / 8042), ((2 : ℚ) / 163), (((-1123) : ℚ) / 8799), (((-332) : ℚ) / 2563), (((-231) : ℚ) / 1900), (((-1282) : ℚ) / 8499), (((-113) : ℚ) / 9803), ((1971 : ℚ) / 9566), (((-1186) : ℚ) / 6445), ((57 : ℚ) / 656)],
  [(((-702) : ℚ) / 4997), ((362 : ℚ) / 3675), ((1532 : ℚ) / 9953), ((1360 : ℚ) / 9719), ((907 : ℚ) / 9903), ((1579 : ℚ) / 9774), (((-712) : ℚ) / 9455), ((92 : ℚ) / 5945), ((303 : ℚ) / 2266), ((1571 : ℚ) / 9288), ((833 : ℚ) / 6632), ((374 : ℚ) / 6065), (((-993) : ℚ) / 7127), (((-79) : ℚ) / 6220), (((-77) : ℚ) / 2183), (((-302) : ℚ) / 2665), (((-344) : ℚ) / 3293), (((-367) : ℚ) / 7211), (((-41) : ℚ) / 715), (((-427) : ℚ) / 8919), ((233 : ℚ) / 2213), (((-699) : ℚ) / 8365), ((869 : ℚ) / 8240), ((223 : ℚ) / 5127), ((244 : ℚ) / 9987), (((-471) : ℚ) / 3767), (((-538) : ℚ) / 8563), (((-153) : ℚ) / 1769), ((297 : ℚ) / 2102), ((144 : ℚ) / 911), (((-379) : ℚ) / 6158), (((-171) : ℚ) / 1967)],
  [((439 : ℚ) / 9080), ((622 : ℚ) / 5517), (((-85) : ℚ) / 1854), ((1083 : ℚ) / 9634), ((214 : ℚ) / 4845), ((1447 : ℚ) / 9693), (((-803) : ℚ) / 4704), ((1725 : ℚ) / 9391), (((-115) : ℚ) / 6189), (((-478) : ℚ) / 8215), ((125 : ℚ) / 4442), (((-1055) : ℚ) / 9156), (((-1141) : ℚ) / 9530), ((779 : ℚ) / 8034), ((693 : ℚ) / 8573), ((109 : ℚ) / 7877), (((-1021) : ℚ) / 8692), ((185 : ℚ) / 2207), (((-399) : ℚ) / 6220), ((73 : ℚ) / 4986), (((-1358) : ℚ) / 5937), ((251 : ℚ) / 5799), (((-355) : ℚ) / 2323), ((461 : ℚ) / 3666), ((836 : ℚ) / 5553), (((-894) : ℚ) / 8413), ((59 : ℚ) / 5685), ((256 : ℚ) / 2091), (((-320) : ℚ) / 3519), ((321 : ℚ) / 4981), ((30 : ℚ) / 1789), (((-366) : ℚ) / 1741)],
  [((421 : ℚ) / 6131), ((652 : ℚ) / 9949), ((377 : ℚ) / 2130), (((-77) : ℚ) / 922), ((179 : ℚ) / 7021), ((113 : ℚ) / 1853), ((81 : ℚ) / 631), ((212 : ℚ) / 2437), (((-447) : ℚ) / 7181), ((21 : ℚ) / 7915), (((-850) : ℚ) / 6719), ((13 : ℚ) / 202), (((-1236) : ℚ) / 9793), (((-1209) : ℚ) / 7523), ((43 : ℚ) / 3232), ((1425 : ℚ) / 9656), ((125 : ℚ) / 5894), ((820 : ℚ) / 6619), ((764 : ℚ) / 4009), (((-217) : ℚ) / 1618), ((605 : ℚ) / 5523), (((-493) : ℚ) / 6237), ((1469 : ℚ) / 8233), (((-274) : ℚ) / 5663), (((-174) : ℚ) / 9283), ((61 : ℚ) / 6691), ((659 : ℚ) / 5610), (((-121) : ℚ) / 965), ((450 : ℚ) / 5897), ((563 : ℚ) / 9659), (((-1645) : ℚ) / 9749), (((-247) : ℚ) / 7569)],
  [((427 : ℚ) / 4681), (((-307) : ℚ) / 9955), (((-82) : ℚ) / 519), (((-123) : ℚ) / 941), ((392 : ℚ) / 3487), ((430 : ℚ) / 4397), ((1347 : ℚ) / 9082), (((-250) : ℚ) / 9219), (((-466) : ℚ) / 4357), (((-194) : ℚ) / 5541), ((252 : ℚ) / 5927), ((435 : ℚ) / 6242), (((-1092) : ℚ) / 9857), ((5 : ℚ) / 332), ((86 : ℚ) / 7897), ((308 : ℚ) / 3499), (((-955) : ℚ) / 7619), ((1161 : ℚ) / 9428), ((275 : ℚ) / 4331), (((-799) : ℚ) / 6756), ((5 : ℚ) / 431), ((1295 : ℚ) / 9881), ((1035 : ℚ) / 9898), ((393 : ℚ) / 8546), (((-341) : ℚ) / 6058), (((-931) : ℚ) / 5332), (((-781) : ℚ) / 9959), (((-1421) : ℚ) / 8840), ((482 : ℚ) / 4795), (((-138) : ℚ) / 1693), (((-1087) : ℚ) / 9392), (((-158) : ℚ) / 3473)],
  [((425 : ℚ) / 5148), ((781 : ℚ) / 8692), ((267 : ℚ) / 6524), (((-432) : ℚ) / 6719), (((-725) : ℚ) / 6437), (((-963) : ℚ) / 9308), (((-1257) : ℚ) / 6163), ((316 : ℚ) / 2849), (((-503) : ℚ) / 4900), (((-181) : ℚ) / 4427), (((-1063) : ℚ) / 8022), (((-459) : ℚ) / 3818), ((466 : ℚ) / 8151), (((-1111) : ℚ) / 7985), (((-49) : ℚ) / 300), (((-235) : ℚ) / 4892), (((-110) : ℚ) / 2867), (((-297) : ℚ) / 2104), ((160 : ℚ) / 9499), ((934 : ℚ) / 5781), (((-3) : ℚ) / 58), ((510 : ℚ) / 3599), (((-10) : ℚ) / 1151), ((514 : ℚ) / 7075), (((-449) : ℚ) / 9864), ((599 : ℚ) / 5435), ((737 : ℚ) / 9396), ((653 : ℚ) / 9854), ((8 : ℚ) / 1533), ((169 : ℚ) / 9448), (((-1488) : ℚ) / 9373), (((-115) : ℚ) / 8407)]
]
def teacherBlock1FFNLinear2Bias : List ℚ := [(((-193) : ℚ) / 8857), (((-209) : ℚ) / 7457), (((-769) : ℚ) / 4760), (((-183) : ℚ) / 8759), ((73 : ℚ) / 2400), (((-15) : ℚ) / 8567), (((-449) : ℚ) / 5907), ((19 : ℚ) / 213), ((375 : ℚ) / 5234), (((-57) : ℚ) / 1201), (((-649) : ℚ) / 3386), (((-78) : ℚ) / 1231), ((677 : ℚ) / 3912), (((-154) : ℚ) / 9047), (((-1375) : ℚ) / 9841), (((-84) : ℚ) / 8387)]
def teacherBlock1FFNLinear2 : Layer where
  weights := teacherBlock1FFNLinear2Weights
  bias := teacherBlock1FFNLinear2Bias

/-- FFN Block: 16 → 32 → 16 -/
def teacherBlock1FFN : FFNBlock where
  linear1 := teacherBlock1FFNLinear1
  linear2 := teacherBlock1FFNLinear2
  dims_match := by simp [teacherBlock1FFNLinear1, teacherBlock1FFNLinear2, teacherBlock1FFNLinear1Weights, teacherBlock1FFNLinear2Weights, Layer.inputDim, Layer.outputDim, teacherBlock1FFNLinear1Bias]

/-- Post-FFN LayerNorm -/
def teacherBlock1LN2Gamma : List ℚ := [((7728 : ℚ) / 7885), ((4942 : ℚ) / 4827), ((9339 : ℚ) / 9046), ((4316 : ℚ) / 4457), ((8689 : ℚ) / 8989), ((8462 : ℚ) / 8081), ((2287 : ℚ) / 2228), ((6046 : ℚ) / 6099), ((8488 : ℚ) / 8341), 1, ((1733 : ℚ) / 1675), ((8755 : ℚ) / 8957), ((2682 : ℚ) / 2677), ((1993 : ℚ) / 1997), ((7475 : ℚ) / 7806), ((7603 : ℚ) / 8260)]
def teacherBlock1LN2Beta : List ℚ := [((153 : ℚ) / 9002), (((-206) : ℚ) / 9461), (((-141) : ℚ) / 7642), ((41 : ℚ) / 2748), ((123 : ℚ) / 9292), ((80 : ℚ) / 3107), (((-105) : ℚ) / 8704), ((238 : ℚ) / 7171), ((8 : ℚ) / 485), (((-47) : ℚ) / 2792), (((-226) : ℚ) / 9115), ((120 : ℚ) / 8563), ((67 : ℚ) / 5329), (((-164) : ℚ) / 9509), (((-135) : ℚ) / 8627), (((-58) : ℚ) / 3871)]
def teacherBlock1LN2Epsilon : ℚ := ((1 : ℚ) / 100000)
def teacherBlock1LN2 : LayerNormParams where
  gamma := teacherBlock1LN2Gamma
  beta := teacherBlock1LN2Beta
  epsilon := teacherBlock1LN2Epsilon
  epsilon_pos := by simp only [teacherBlock1LN2Epsilon]; norm_num

/-- Transformer Block: dim=16, hidden=32 -/
def teacherBlock1 : TransformerBlock where
  ln1 := teacherBlock1LN1
  ffn := teacherBlock1FFN
  ln2 := teacherBlock1LN2

/-! ## Layer 2 -/

/-- Pre-FFN LayerNorm -/
def teacherBlock2LN1Gamma : List ℚ := [((1407 : ℚ) / 1439), ((9726 : ℚ) / 9451), ((9596 : ℚ) / 9911), ((1051 : ℚ) / 1074), ((4915 : ℚ) / 4796), ((10269 : ℚ) / 9976), ((9055 : ℚ) / 9013), ((3593 : ℚ) / 3713), ((2367 : ℚ) / 2363), ((1235 : ℚ) / 1242), ((5114 : ℚ) / 5147), ((2435 : ℚ) / 2356), ((1267 : ℚ) / 1234), ((6668 : ℚ) / 6429), ((4409 : ℚ) / 4322), ((3674 : ℚ) / 3539)]
def teacherBlock2LN1Beta : List ℚ := [(((-121) : ℚ) / 3326), ((1 : ℚ) / 4305), ((109 : ℚ) / 6089), ((11 : ℚ) / 1640), (((-159) : ℚ) / 9371), ((163 : ℚ) / 7996), ((5 : ℚ) / 523), (((-75) : ℚ) / 2809), ((12 : ℚ) / 739), (((-151) : ℚ) / 9609), ((263 : ℚ) / 9605), (((-87) : ℚ) / 4126), ((55 : ℚ) / 2896), (((-13) : ℚ) / 367), (((-11) : ℚ) / 480), ((233 : ℚ) / 9821)]
def teacherBlock2LN1Epsilon : ℚ := ((1 : ℚ) / 100000)
def teacherBlock2LN1 : LayerNormParams where
  gamma := teacherBlock2LN1Gamma
  beta := teacherBlock2LN1Beta
  epsilon := teacherBlock2LN1Epsilon
  epsilon_pos := by simp only [teacherBlock2LN1Epsilon]; norm_num

/-- Feed-Forward Network -/
def teacherBlock2FFNLinear1Weights : List (List ℚ) := [
  [(((-1273) : ℚ) / 9556), ((213 : ℚ) / 4619), ((156 : ℚ) / 1585), ((397 : ℚ) / 4550), (((-49) : ℚ) / 3245), ((198 : ℚ) / 5461), (((-1057) : ℚ) / 7520), (((-937) : ℚ) / 9288), (((-113) : ℚ) / 1367), ((459 : ℚ) / 3793), (((-648) : ℚ) / 3487), ((2171 : ℚ) / 9028), (((-377) : ℚ) / 9653), (((-1981) : ℚ) / 9817), (((-313) : ℚ) / 6818), ((803 : ℚ) / 8617)],
  [(((-313) : ℚ) / 3033), ((811 : ℚ) / 7270), (((-4) : ℚ) / 79), (((-193) : ℚ) / 2731), (((-593) : ℚ) / 5676), ((802 : ℚ) / 3603), ((769 : ℚ) / 9998), (((-1647) : ℚ) / 7784), ((294 : ℚ) / 2743), ((1525 : ℚ) / 9831), (((-2477) : ℚ) / 9071), (((-1736) : ℚ) / 7907), ((2657 : ℚ) / 9596), ((1255 : ℚ) / 6066), (((-153) : ℚ) / 8011), ((2281 : ℚ) / 9883)],
  [(((-447) : ℚ) / 9782), ((2499 : ℚ) / 8342), (((-50) : ℚ) / 4139), (((-1158) : ℚ) / 4525), (((-289) : ℚ) / 1648), ((893 : ℚ) / 9221), ((141 : ℚ) / 6011), ((87 : ℚ) / 1805), (((-80) : ℚ) / 8447), (((-346) : ℚ) / 3613), ((131 : ℚ) / 9669), ((920 : ℚ) / 9381), ((346 : ℚ) / 9233), (((-1779) : ℚ) / 6278), (((-102) : ℚ) / 1265), ((919 : ℚ) / 6925)],
  [(((-982) : ℚ) / 5093), (((-2046) : ℚ) / 8533), ((761 : ℚ) / 7363), (((-1233) : ℚ) / 7489), (((-667) : ℚ) / 9322), ((481 : ℚ) / 2147), ((83 : ℚ) / 2511), (((-1607) : ℚ) / 8423), ((736 : ℚ) / 4897), ((5 : ℚ) / 164), ((629 : ℚ) / 2480), (((-237) : ℚ) / 9487), ((2017 : ℚ) / 8800), (((-554) : ℚ) / 9855), ((856 : ℚ) / 3849), ((1184 : ℚ) / 5025)],
  [(((-710) : ℚ) / 6409), ((759 : ℚ) / 6227), (((-2185) : ℚ) / 9809), ((438 : ℚ) / 8255), (((-134) : ℚ) / 9811), ((422 : ℚ) / 1701), ((156 : ℚ) / 2651), ((286 : ℚ) / 8139), (((-212) : ℚ) / 7639), ((640 : ℚ) / 5593), (((-5) : ℚ) / 32), (((-144) : ℚ) / 9677), (((-953) : ℚ) / 8783), (((-637) : ℚ) / 2281), ((599 : ℚ) / 9371), ((2321 : ℚ) / 8706)],
  [((303 : ℚ) / 9428), (((-43) : ℚ) / 9379), ((1205 : ℚ) / 8907), ((298 : ℚ) / 3407), ((1441 : ℚ) / 8269), ((1551 : ℚ) / 7312), ((1487 : ℚ) / 9266), ((233 : ℚ) / 5416), ((2287 : ℚ) / 9657), (((-230) : ℚ) / 8571), (((-697) : ℚ) / 8123), ((397 : ℚ) / 9734), ((451 : ℚ) / 1838), (((-1621) : ℚ) / 7473), (((-529) : ℚ) / 2807), ((1835 : ℚ) / 7559)],
  [(((-181) : ℚ) / 7347), ((292 : ℚ) / 1359), ((776 : ℚ) / 7435), ((715 : ℚ) / 6668), ((199 : ℚ) / 7918), (((-686) : ℚ) / 5715), (((-41) : ℚ) / 194), ((609 : ℚ) / 6089), (((-718) : ℚ) / 9273), (((-1185) : ℚ) / 9946), (((-709) : ℚ) / 3097), ((1444 : ℚ) / 9763), ((738 : ℚ) / 8881), ((503 : ℚ) / 3774), ((294 : ℚ) / 7253), (((-43) : ℚ) / 624)],
  [((353 : ℚ) / 1743), ((67 : ℚ) / 668), ((402 : ℚ) / 4459), ((940 : ℚ) / 8497), (((-2355) : ℚ) / 9503), ((62 : ℚ) / 489), ((449 : ℚ) / 5046), ((209 : ℚ) / 1416), ((1381 : ℚ) / 5523), (((-497) : ℚ) / 8695), (((-139) : ℚ) / 1850), (((-1153) : ℚ) / 7079), ((790 : ℚ) / 9113), (((-56) : ℚ) / 8581), (((-92) : ℚ) / 453), ((1260 : ℚ) / 5491)],
  [((799 : ℚ) / 4177), (((-43) : ℚ) / 350), (((-781) : ℚ) / 9881), ((1567 : ℚ) / 9991), (((-659) : ℚ) / 5385), ((36 : ℚ) / 437), (((-1448) : ℚ) / 6121), ((437 : ℚ) / 9238), ((183 : ℚ) / 1168), ((1069 : ℚ) / 7864), ((760 : ℚ) / 9563), (((-999) : ℚ) / 6032), ((2798 : ℚ) / 9925), ((833 : ℚ) / 5288), ((467 : ℚ) / 3506), (((-11) : ℚ) / 254)],
  [(((-1151) : ℚ) / 6896), (((-1188) : ℚ) / 6335), ((1393 : ℚ) / 9995), (((-1291) : ℚ) / 6855), (((-774) : ℚ) / 6491), ((65 : ℚ) / 2036), ((35 : ℚ) / 1067), (((-441) : ℚ) / 3314), (((-367) : ℚ) / 4246), (((-18) : ℚ) / 3131), ((214 : ℚ) / 1749), (((-464) : ℚ) / 3699), (((-215) : ℚ) / 1966), (((-409) : ℚ) / 1514), ((491 : ℚ) / 2280), ((1519 : ℚ) / 8608)],
  [(((-1032) : ℚ) / 4105), (((-2071) : ℚ) / 9768), ((2429 : ℚ) / 6203), ((164 : ℚ) / 8795), ((1209 : ℚ) / 8744), (((-429) : ℚ) / 2026), (((-74) : ℚ) / 2271), ((431 : ℚ) / 6814), ((1051 : ℚ) / 9959), ((265 : ℚ) / 2689), ((719 : ℚ) / 6965), ((305 : ℚ) / 2447), (((-795) : ℚ) / 4829), ((1361 : ℚ) / 5452), ((338 : ℚ) / 8301), ((13 : ℚ) / 1107)],
  [(((-891) : ℚ) / 3428), (((-2331) : ℚ) / 9334), (((-1063) : ℚ) / 4269), ((233 : ℚ) / 1233), ((255 : ℚ) / 2392), ((13 : ℚ) / 63), (((-1264) : ℚ) / 8207), ((851 : ℚ) / 8095), ((5 : ℚ) / 209), ((1362 : ℚ) / 6005), (((-1224) : ℚ) / 9517), (((-604) : ℚ) / 7099), (((-495) : ℚ) / 9656), (((-938) : ℚ) / 3817), ((47 : ℚ) / 3045), (((-173) : ℚ) / 1708)],
  [((188 : ℚ) / 9727), (((-1291) : ℚ) / 9136), (((-565) : ℚ) / 8618), (((-503) : ℚ) / 6133), (((-1219) : ℚ) / 6993), (((-236) : ℚ) / 9795), ((441 : ℚ) / 4558), ((38 : ℚ) / 4895), (((-784) : ℚ) / 7625), ((1647 : ℚ) / 8080), (((-1423) : ℚ) / 8171), ((1084 : ℚ) / 4121), (((-2395) : ℚ) / 9599), ((2336 : ℚ) / 8779), ((761 : ℚ) / 7137), (((-826) : ℚ) / 4607)],
  [((905 : ℚ) / 9763), (((-207) : ℚ) / 1112), (((-437) : ℚ) / 8282), ((163 : ℚ) / 7083), (((-570) : ℚ) / 3367), ((180 : ℚ) / 3287), ((1595 : ℚ) / 7129), ((297 : ℚ) / 9094), ((1253 : ℚ) / 9634), ((534 : ℚ) / 5539), ((1649 : ℚ) / 9759), ((527 : ℚ) / 4143), (((-197) : ℚ) / 6476), (((-31) : ℚ) / 158), ((708 : ℚ) / 4907), (((-224) : ℚ) / 8093)],
  [(((-131) : ℚ) / 7248), ((46 : ℚ) / 9961), (((-923) : ℚ) / 9787), (((-605) : ℚ) / 5218), ((763 : ℚ) / 8192), (((-197) : ℚ) / 2594), (((-190) : ℚ) / 3581), ((596 : ℚ) / 7889), (((-451) : ℚ) / 9107), (((-33) : ℚ) / 1043), (((-556) : ℚ) / 3929), ((887 : ℚ) / 3262), ((1807 : ℚ) / 9641), (((-959) : ℚ) / 7730), ((1406 : ℚ) / 5427), (((-1264) : ℚ) / 5179)],
  [(((-1784) : ℚ) / 8957), (((-1825) : ℚ) / 9614), (((-313) : ℚ) / 9669), (((-428) : ℚ) / 3777), (((-1775) : ℚ) / 9996), ((443 : ℚ) / 2398), (((-733) : ℚ) / 7294), ((1073 : ℚ) / 4536), (((-265) : ℚ) / 9937), ((55 : ℚ) / 2127), ((1358 : ℚ) / 9229), (((-419) : ℚ) / 4842), ((1201 : ℚ) / 9231), ((217 : ℚ) / 3293), ((176 : ℚ) / 8075), (((-806) : ℚ) / 9849)],
  [(((-206) : ℚ) / 1461), (((-719) : ℚ) / 5561), ((706 : ℚ) / 8763), (((-24) : ℚ) / 593), (((-361) : ℚ) / 1571), (((-546) : ℚ) / 4469), (((-2165) : ℚ) / 9614), ((700 : ℚ) / 2903), ((216 : ℚ) / 2615), ((1369 : ℚ) / 9893), ((203 : ℚ) / 1098), (((-914) : ℚ) / 8543), (((-753) : ℚ) / 8665), (((-926) : ℚ) / 8639), (((-1303) : ℚ) / 8919), ((218 : ℚ) / 4921)],
  [((1231 : ℚ) / 6518), ((661 : ℚ) / 6471), ((340 : ℚ) / 6557), (((-442) : ℚ) / 4455), (((-797) : ℚ) / 9219), (((-2723) : ℚ) / 9951), (((-872) : ℚ) / 4477), ((109 : ℚ) / 3041), (((-62) : ℚ) / 7965), (((-2138) : ℚ) / 9891), ((115 : ℚ) / 4572), (((-919) : ℚ) / 5754), (((-1681) : ℚ) / 6845), (((-1471) : ℚ) / 8659), (((-869) : ℚ) / 6704), (((-454) : ℚ) / 1757)],
  [((208 : ℚ) / 4115), (((-743) : ℚ) / 8901), ((501 : ℚ) / 5351), ((1802 : ℚ) / 9971), ((1702 : ℚ) / 7129), (((-1912) : ℚ) / 8131), (((-451) : ℚ) / 2855), (((-76) : ℚ) / 5965), (((-593) : ℚ) / 6586), ((5 : ℚ) / 431), (((-1439) : ℚ) / 7725), ((401 : ℚ) / 7478), ((173 : ℚ) / 1108), ((562 : ℚ) / 6991), (((-1373) : ℚ) / 9813), (((-821) : ℚ) / 4739)],
  [((1537 : ℚ) / 9990), (((-734) : ℚ) / 3879), (((-1001) : ℚ) / 5636), ((13 : ℚ) / 8728), (((-197) : ℚ) / 4487), ((211 : ℚ) / 7946), (((-502) : ℚ) / 8991), ((213 : ℚ) / 6347), (((-1107) : ℚ) / 9859), ((1447 : ℚ) / 9698), (((-1727) : ℚ) / 8445), (((-905) : ℚ) / 7243), ((1754 : ℚ) / 9159), ((269 : ℚ) / 1951), (((-689) : ℚ) / 5139), ((229 : ℚ) / 9325)],
  [(((-51) : ℚ) / 1010), ((454 : ℚ) / 3863), (((-927) : ℚ) / 9347), (((-721) : ℚ) / 6501), ((65 : ℚ) / 3742), (((-1441) : ℚ) / 9107), (((-1272) : ℚ) / 6649), (((-1191) : ℚ) / 7312), (((-335) : ℚ) / 8346), (((-205) : ℚ) / 1344), (((-746) : ℚ) / 3797), ((645 : ℚ) / 6607), (((-511) : ℚ) / 6415), ((1371 : ℚ) / 8936), ((638 : ℚ) / 7317), ((85 : ℚ) / 1588)],
  [(((-1057) : ℚ) / 8494), (((-472) : ℚ) / 4463), ((79 : ℚ) / 4620), ((29 : ℚ) / 479), ((625 : ℚ) / 6407), ((716 : ℚ) / 6657), ((380 : ℚ) / 4079), (((-256) : ℚ) / 8985), (((-438) : ℚ) / 7255), (((-21) : ℚ) / 2782), ((632 : ℚ) / 8033), (((-1765) : ℚ) / 8247), ((257 : ℚ) / 9459), (((-1101) : ℚ) / 5161), (((-165) : ℚ) / 7336), ((1152 : ℚ) / 4303)],
  [((27 : ℚ) / 200), ((631 : ℚ) / 5433), (((-985) : ℚ) / 3922), ((977 : ℚ) / 9242), ((260 : ℚ) / 7981), (((-179) : ℚ) / 1656), ((892 : ℚ) / 4911), (((-1897) : ℚ) / 8558), (((-541) : ℚ) / 4863), (((-2351) : ℚ) / 9865), (((-24) : ℚ) / 691), (((-715) : ℚ) / 5394), ((966 : ℚ) / 6287), ((2113 : ℚ) / 9146), ((2353 : ℚ) / 9214), ((1305 : ℚ) / 9659)],
  [(((-875) : ℚ) / 8566), (((-1373) : ℚ) / 8324), (((-23) : ℚ) / 2504), (((-333) : ℚ) / 8014), ((1567 : ℚ) / 8164), (((-715) : ℚ) / 8972), ((1098 : ℚ) / 7129), (((-1053) : ℚ) / 8117), (((-503) : ℚ) / 9152), (((-344) : ℚ) / 8631), (((-62) : ℚ) / 1127), ((2283 : ℚ) / 9874), (((-663) : ℚ) / 3059), ((487 : ℚ) / 3370), (((-2159) : ℚ) / 8838), (((-141) : ℚ) / 4589)],
  [((82 : ℚ) / 1105), ((407 : ℚ) / 3508), (((-133) : ℚ) / 820), (((-253) : ℚ) / 2262), (((-728) : ℚ) / 6883), ((377 : ℚ) / 6729), (((-587) : ℚ) / 9966), (((-219) : ℚ) / 3074), ((933 : ℚ) / 9289), (((-44) : ℚ) / 379), ((1220 : ℚ) / 6393), (((-280) : ℚ) / 1707), ((209 : ℚ) / 7442), ((77 : ℚ) / 9990), ((449 : ℚ) / 9544), (((-75) : ℚ) / 1978)],
  [(((-1247) : ℚ) / 8445), (((-1031) : ℚ) / 9909), (((-105) : ℚ) / 7736), ((1047 : ℚ) / 5288), (((-1021) : ℚ) / 8911), ((1221 : ℚ) / 5008), ((1492 : ℚ) / 6315), ((36 : ℚ) / 9319), ((2041 : ℚ) / 8842), ((11 : ℚ) / 1702), (((-1561) : ℚ) / 9409), ((1551 : ℚ) / 8599), ((503 : ℚ) / 3167), ((8 : ℚ) / 229), ((789 : ℚ) / 9815), ((820 : ℚ) / 7281)],
  [((1398 : ℚ) / 8891), (((-3) : ℚ) / 8249), (((-415) : ℚ) / 2412), ((269 : ℚ) / 2736), ((403 : ℚ) / 9924), (((-349) : ℚ) / 2787), (((-367) : ℚ) / 9203), ((128 : ℚ) / 1947), (((-805) : ℚ) / 5217), ((774 : ℚ) / 8885), (((-809) : ℚ) / 6308), ((1237 : ℚ) / 9947), (((-1151) : ℚ) / 9326), (((-774) : ℚ) / 4361), (((-688) : ℚ) / 2517), ((813 : ℚ) / 9235)],
  [(((-95) : ℚ) / 1871), (((-2070) : ℚ) / 9139), (((-971) : ℚ) / 5816), (((-269) : ℚ) / 5670), ((2326 : ℚ) / 9095), (((-385) : ℚ) / 6478), ((932 : ℚ) / 9327), ((653 : ℚ) / 3103), ((987 : ℚ) / 9634), ((72 : ℚ) / 1963), (((-2059) : ℚ) / 9817), (((-1418) : ℚ) / 6431), (((-463) : ℚ) / 4288), (((-1315) : ℚ) / 6469), ((192 : ℚ) / 3739), ((1684 : ℚ) / 7373)],
  [(((-243) : ℚ) / 3580), ((193 : ℚ) / 8907), ((1404 : ℚ) / 9167), ((1429 : ℚ) / 6686), (((-813) : ℚ) / 3436), (((-1469) : ℚ) / 9156), (((-311) : ℚ) / 2897), ((261 : ℚ) / 4363), ((908 : ℚ) / 5467), (((-134) : ℚ) / 933), ((1471 : ℚ) / 7980), ((396 : ℚ) / 8561), ((2070 : ℚ) / 9847), ((1556 : ℚ) / 9929), ((957 : ℚ) / 5834), ((47 : ℚ) / 2675)],
  [((83 : ℚ) / 3113), (((-534) : ℚ) / 7363), ((2532 : ℚ) / 8371), (((-1858) : ℚ) / 8437), (((-939) : ℚ) / 6178), (((-681) : ℚ) / 3778), (((-727) : ℚ) / 4100), ((1322 : ℚ) / 8185), (((-2923) : ℚ) / 9972), (((-149) : ℚ) / 7876), ((1327 : ℚ) / 9751), ((222 : ℚ) / 9667), ((898 : ℚ) / 9037), ((446 : ℚ) / 9661), (((-507) : ℚ) / 2162), (((-288) : ℚ) / 1183)],
  [(((-691) : ℚ) / 5674), (((-437) : ℚ) / 8307), ((81 : ℚ) / 1282), (((-1222) : ℚ) / 4829), (((-629) : ℚ) / 7987), (((-1285) : ℚ) / 6984), ((323 : ℚ) / 8663), ((1457 : ℚ) / 9991), (((-277) : ℚ) / 3120), ((1080 : ℚ) / 8039), ((553 : ℚ) / 8693), (((-412) : ℚ) / 5571), ((268 : ℚ) / 9487), (((-697) : ℚ) / 3181), ((1239 : ℚ) / 9218), ((2485 : ℚ) / 9831)],
  [((1 : ℚ) / 310), (((-62) : ℚ) / 3173), (((-586) : ℚ) / 3475), ((369 : ℚ) / 5960), ((1010 : ℚ) / 8907), ((2579 : ℚ) / 9804), (((-556) : ℚ) / 2849), ((1369 : ℚ) / 5421), ((1232 : ℚ) / 6367), ((249 : ℚ) / 1751), (((-1004) : ℚ) / 5527), ((688 : ℚ) / 4707), ((1473 : ℚ) / 7250), (((-301) : ℚ) / 2071), (((-1205) : ℚ) / 6034), (((-1388) : ℚ) / 9711)]
]
def teacherBlock2FFNLinear1Bias : List ℚ := [(((-117) : ℚ) / 2270), ((244 : ℚ) / 2869), ((165 : ℚ) / 9323), ((957 : ℚ) / 9899), ((1708 : ℚ) / 9535), ((333 : ℚ) / 1651), (((-2330) : ℚ) / 9059), ((202 : ℚ) / 3071), (((-114) : ℚ) / 7337), ((2106 : ℚ) / 8855), (((-811) : ℚ) / 3837), ((1146 : ℚ) / 4861), (((-1168) : ℚ) / 9085), (((-583) : ℚ) / 3716), (((-793) : ℚ) / 3647), ((509 : ℚ) / 4656), (((-2027) : ℚ) / 8058), (((-124) : ℚ) / 4079), (((-416) : ℚ) / 8639), ((1388 : ℚ) / 8927), ((307 : ℚ) / 5518), ((1373 : ℚ) / 5533), ((291 : ℚ) / 6610), ((190 : ℚ) / 2997), (((-181) : ℚ) / 6267), ((97 : ℚ) / 1168), ((118 : ℚ) / 671), (((-1526) : ℚ) / 8117), (((-224) : ℚ) / 4965), (((-1035) : ℚ) / 4463), ((1201 : ℚ) / 9050), ((691 : ℚ) / 6908)]
def teacherBlock2FFNLinear1 : Layer where
  weights := teacherBlock2FFNLinear1Weights
  bias := teacherBlock2FFNLinear1Bias

def teacherBlock2FFNLinear2Weights : List (List ℚ) := [
  [((811 : ℚ) / 8430), ((508 : ℚ) / 2993), ((838 : ℚ) / 6327), (((-246) : ℚ) / 6043), (((-188) : ℚ) / 4321), ((373 : ℚ) / 1970), ((678 : ℚ) / 7133), ((97 : ℚ) / 9904), ((315 : ℚ) / 7393), ((1347 : ℚ) / 7960), ((871 : ℚ) / 6722), (((-104) : ℚ) / 6893), (((-1322) : ℚ) / 9199), (((-5) : ℚ) / 79), (((-679) : ℚ) / 6585), ((459 : ℚ) / 4783), (((-727) : ℚ) / 5272), ((315 : ℚ) / 9389), ((271 : ℚ) / 7359), (((-161) : ℚ) / 1510), (((-1595) : ℚ) / 9766), ((291 : ℚ) / 6823), (((-397) : ℚ) / 2921), (((-1046) : ℚ) / 5069), (((-293) : ℚ) / 6009), ((1700 : ℚ) / 9731), (((-1132) : ℚ) / 6043), (((-601) : ℚ) / 4860), (((-1309) : ℚ) / 8607), (((-332) : ℚ) / 9119), ((521 : ℚ) / 2786), ((173 : ℚ) / 2758)],
  [(((-579) : ℚ) / 5965), (((-46) : ℚ) / 975), (((-163) : ℚ) / 5975), (((-832) : ℚ) / 9311), (((-501) : ℚ) / 5579), ((515 : ℚ) / 4052), (((-946) : ℚ) / 8515), (((-1601) : ℚ) / 7899), (((-901) : ℚ) / 7669), (((-289) : ℚ) / 3209), (((-213) : ℚ) / 2257), (((-1352) : ℚ) / 9829), ((319 : ℚ) / 2553), (((-201) : ℚ) / 2735), ((435 : ℚ) / 7181), (((-393) : ℚ) / 8680), (((-76) : ℚ) / 5533), (((-218) : ℚ) / 1767), ((305 : ℚ) / 6949), (((-1421) : ℚ) / 9329), ((678 : ℚ) / 8821), (((-1026) : ℚ) / 7777), (((-17) : ℚ) / 3343), ((5 : ℚ) / 251), ((219 : ℚ) / 5740), ((13 : ℚ) / 4434), (((-717) : ℚ) / 9835), (((-1) : ℚ) / 9147), (((-422) : ℚ) / 8003), ((257 : ℚ) / 2944), ((585 : ℚ) / 6743), (((-1521) : ℚ) / 9995)],
  [(((-35) : ℚ) / 254), (((-221) : ℚ) / 1783), ((26 : ℚ) / 983), (((-37) : ℚ) / 2692), (((-700) : ℚ) / 8111), (((-485) : ℚ) / 5262), ((1033 : ℚ) / 6222), (((-704) : ℚ) / 5385), (((-459) : ℚ) / 7256), (((-263) : ℚ) / 8098), ((913 : ℚ) / 9719), ((569 : ℚ) / 5287), ((378 : ℚ) / 2531), ((173 : ℚ) / 2621), (((-843) : ℚ) / 8104), ((1087 : ℚ) / 8414), ((209 : ℚ) / 2763), (((-757) : ℚ) / 8647), ((869 : ℚ) / 9081), ((1501 : ℚ) / 9961), ((45 : ℚ) / 8489), (((-141) : ℚ) / 1387), (((-25) : ℚ) / 211), ((1318 : ℚ) / 9059), (((-2038) : ℚ) / 9995), (((-1149) : ℚ) / 6547), (((-1294) : ℚ) / 9557), (((-622) : ℚ) / 4087), ((203 : ℚ) / 9985), ((876 : ℚ) / 4463), ((3 : ℚ) / 2455), ((979 : ℚ) / 8137)],
  [(((-211) : ℚ) / 4498), ((511 : ℚ) / 4653), (((-520) : ℚ) / 9123), ((843 : ℚ) / 6796), (((-308) : ℚ) / 8511), ((818 : ℚ) / 9095), (((-838) : ℚ) / 7601), ((265 : ℚ) / 4251), ((53 : ℚ) / 347), ((166 : ℚ) / 1887), (((-179) : ℚ) / 8513), ((255 : ℚ) / 1928), ((245 : ℚ) / 5069), (((-805) : ℚ) / 6032), (((-6) : ℚ) / 1573), (((-401) : ℚ) / 9958), ((307 : ℚ) / 8537), ((672 : ℚ) / 8905), (((-6) : ℚ) / 7967), (((-274) : ℚ) / 3207), (((-589) : ℚ) / 9757), ((10 : ℚ) / 4209), (((-1052) : ℚ) / 7349), ((371 : ℚ) / 4899), (((-281) : ℚ) / 8060), (((-230) : ℚ) / 5379), (((-1131) : ℚ) / 6727), (((-254) : ℚ) / 6987), (((-57) : ℚ) / 8465), ((177 : ℚ) / 6067), (((-851) : ℚ) / 8093), (((-5) : ℚ) / 728)],
  [(((-552) : ℚ) / 9337), ((19 : ℚ) / 457), (((-450) : ℚ) / 9829), ((317 : ℚ) / 9672), (((-1267) : ℚ) / 9350), ((535 : ℚ) / 5116), ((402 : ℚ) / 8891), ((1502 : ℚ) / 9511), (((-69) : ℚ) / 3175), (((-39) : ℚ) / 3271), ((254 : ℚ) / 5689), ((577 : ℚ) / 5873), (((-479) : ℚ) / 9570), (((-361) : ℚ) / 9670), ((375 : ℚ) / 8614), (((-509) : ℚ) / 5778), (((-681) : ℚ) / 7069), (((-862) : ℚ) / 5217), (((-1) : ℚ) / 12), ((1415 : ℚ) / 8572), ((1157 : ℚ) / 6792), (((-343) : ℚ) / 2834), (((-156) : ℚ) / 9131), (((-1963) : ℚ) / 9617), ((1195 : ℚ) / 7134), (((-794) : ℚ) / 9237), (((-155) : ℚ) / 2153), (((-24) : ℚ) / 955), ((611 : ℚ) / 9595), ((376 : ℚ) / 7041), ((491 : ℚ) / 9911), ((1257 : ℚ) / 9362)],
  [((197 : ℚ) / 8513), (((-77) : ℚ) / 1467), ((446 : ℚ) / 5651), (((-412) : ℚ) / 3641), (((-235) : ℚ) / 7542), (((-277) : ℚ) / 9971), (((-323) : ℚ) / 9579), ((1591 : ℚ) / 8250), ((1145 : ℚ) / 9802), ((19 : ℚ) / 1417), (((-25) : ℚ) / 282), ((1291 : ℚ) / 6183), ((223 : ℚ) / 4216), (((-205) : ℚ) / 2899), (((-645) : ℚ) / 7339), ((1359 : ℚ) / 9674), (((-559) : ℚ) / 7750), (((-696) : ℚ) / 6799), (((-834) : ℚ) / 7531), ((97 : ℚ) / 9087), ((1154 : ℚ) / 8237), ((13 : ℚ) / 1348), (((-533) : ℚ) / 6352), ((293 : ℚ) / 8144), ((743 : ℚ) / 8297), ((216 : ℚ) / 4679), ((1 : ℚ) / 42), ((118 : ℚ) / 761), ((85 : ℚ) / 9551), (((-335) : ℚ) / 3474), (((-1101) : ℚ) / 8290), ((563 : ℚ) / 8927)],
  [(((-365) : ℚ) / 2432), ((135 : ℚ) / 8618), (((-997) : ℚ) / 4363), (((-146) : ℚ) / 5139), ((234 : ℚ) / 7181), ((119 : ℚ) / 3511), ((7 : ℚ) / 4029), (((-708) : ℚ) / 6121), (((-1629) : ℚ) / 8686), (((-1615) : ℚ) / 9208), (((-135) : ℚ) / 6074), ((927 : ℚ) / 8150), (((-572) : ℚ) / 8111), ((1027 : ℚ) / 9552), ((65 : ℚ) / 4072), (((-319) : ℚ) / 3155), (((-1013) : ℚ) / 9390), ((308 : ℚ) / 4091), ((1908 : ℚ) / 9991), ((939 : ℚ) / 9619), ((220 : ℚ) / 2107), ((1430 : ℚ) / 9707), (((-668) : ℚ) / 7167), (((-85) : ℚ) / 8489), (((-1697) : ℚ) / 8951), (((-747) : ℚ) / 5219), (((-643) : ℚ) / 9013), (((-591) : ℚ) / 9605), (((-89) : ℚ) / 939), ((542 : ℚ) / 7883), ((1369 : ℚ) / 9967), ((1309 : ℚ) / 8016)],
  [((1057 : ℚ) / 8506), ((231 : ℚ) / 3583), (((-448) : ℚ) / 5921), ((419 : ℚ) / 5898), ((181 : ℚ) / 784), ((1087 : ℚ) / 4913), (((-886) : ℚ) / 6541), ((904 : ℚ) / 4897), (((-134) : ℚ) / 7067), ((856 : ℚ) / 8623), ((106 : ℚ) / 5069), ((119 : ℚ) / 370), (((-1084) : ℚ) / 8459), ((571 : ℚ) / 3140), ((280 : ℚ) / 4903), (((-57) : ℚ) / 5524), (((-73) : ℚ) / 2902), (((-955) : ℚ) / 5179), ((153 : ℚ) / 8318), ((2628 : ℚ) / 9767), ((681 : ℚ) / 6652), ((120 : ℚ) / 571), (((-872) : ℚ) / 9709), ((464 : ℚ) / 9659), ((643 : ℚ) / 9856), (((-760) : ℚ) / 9919), (((-883) : ℚ) / 6792), ((51 : ℚ) / 250), (((-89) : ℚ) / 1355), ((17 : ℚ) / 8688), ((787 : ℚ) / 5130), ((50 : ℚ) / 383)],
  [(((-387) : ℚ) / 2144), (((-642) : ℚ) / 8023), (((-329) : ℚ) / 5206), (((-528) : ℚ) / 5149), ((843 : ℚ) / 6398), (((-340) : ℚ) / 5101), (((-61) : ℚ) / 451), (((-589) : ℚ) / 6263), (((-111) : ℚ) / 1124), (((-587) : ℚ) / 8767), (((-665) : ℚ) / 4667), (((-881) : ℚ) / 9127), (((-158) : ℚ) / 2873), ((1033 : ℚ) / 6686), (((-264) : ℚ) / 9103), (((-129) : ℚ) / 9764), (((-49) : ℚ) / 3055), ((85 : ℚ) / 7729), (((-506) : ℚ) / 8597), ((547 : ℚ) / 9394), (((-847) : ℚ) / 9617), ((1325 : ℚ) / 7556), ((1311 : ℚ) / 7262), (((-519) : ℚ) / 5812), ((378 : ℚ) / 9931), ((107 : ℚ) / 1344), (((-501) : ℚ) / 6461), (((-678) : ℚ) / 9737), ((99 : ℚ) / 8077), (((-249) : ℚ) / 2575), ((177 : ℚ) / 1061), ((819 : ℚ) / 5219)],
  [(((-249) : ℚ) / 3455), (((-335) : ℚ) / 5408), ((49 : ℚ) / 486), ((493 : ℚ) / 9879), ((251 : ℚ) / 2171), (((-620) : ℚ) / 9301), (((-11) : ℚ) / 393), (((-883) : ℚ) / 5316), ((626 : ℚ) / 7077), (((-413) : ℚ) / 7279), (((-9) : ℚ) / 1153), (((-302) : ℚ) / 3697), ((17 : ℚ) / 457), (((-1173) : ℚ) / 7484), (((-786) : ℚ) / 7229), ((522 : ℚ) / 6247), (((-713) : ℚ) / 4648), ((979 : ℚ) / 9018), ((925 : ℚ) / 7542), ((305 : ℚ) / 3802), ((99 : ℚ) / 815), (((-1261) : ℚ) / 7783), (((-16) : ℚ) / 4547), ((940 : ℚ) / 9761), (((-781) : ℚ) / 7236), (((-7) : ℚ) / 229), ((148 : ℚ) / 6691), ((893 : ℚ) / 8407), ((107 : ℚ) / 8309), ((163 : ℚ) / 8767), (((-125) : ℚ) / 8886), ((485 : ℚ) / 7888)],
  [((479 : ℚ) / 3753), (((-37) : ℚ) / 574), ((148 : ℚ) / 9611), (((-1004) : ℚ) / 9395), (((-1013) : ℚ) / 9970), (((-305) : ℚ) / 5106), (((-269) : ℚ) / 8145), (((-1) : ℚ) / 35), (((-849) : ℚ) / 9185), (((-554) : ℚ) / 7873), ((1874 : ℚ) / 9165), (((-679) : ℚ) / 7034), ((745 : ℚ) / 9709), ((845 : ℚ) / 9237), (((-471) : ℚ) / 8780), (((-1782) : ℚ) / 9055), ((803 : ℚ) / 4062), ((31 : ℚ) / 6458), (((-55) : ℚ) / 9298), (((-1927) : ℚ) / 9934), ((1295 : ℚ) / 9253), ((907 : ℚ) / 7719), ((25 : ℚ) / 1082), ((1218 : ℚ) / 9983), (((-37) : ℚ) / 4924), ((915 : ℚ) / 7883), ((11 : ℚ) / 59), (((-869) : ℚ) / 7727), ((92 : ℚ) / 1027), (((-379) : ℚ) / 4147), ((242 : ℚ) / 9475), (((-523) : ℚ) / 9993)],
  [(((-867) : ℚ) / 8101), (((-1249) : ℚ) / 7982), ((16 : ℚ) / 337), ((792 : ℚ) / 4943), ((559 : ℚ) / 3851), ((369 : ℚ) / 5795), (((-95) : ℚ) / 747), ((117 : ℚ) / 4933), ((173 : ℚ) / 3026), ((269 : ℚ) / 5849), (((-125) : ℚ) / 7429), ((159 : ℚ) / 1009), (((-604) : ℚ) / 8551), (((-881) : ℚ) / 9171), ((145 : ℚ) / 8641), ((894 : ℚ) / 9779), (((-537) : ℚ) / 3815), (((-1021) : ℚ) / 8626), ((641 : ℚ) / 9704), (((-705) : ℚ) / 9887), ((940 : ℚ) / 8411), (((-373) : ℚ) / 9547), (((-189) : ℚ) / 1319), (((-1867) : ℚ) / 9393), ((639 : ℚ) / 9404), ((153 : ℚ) / 1250), ((15 : ℚ) / 3898), (((-18) : ℚ) / 7739), ((591 : ℚ) / 6038), ((1167 : ℚ) / 9556), ((406 : ℚ) / 3553), (((-262) : ℚ) / 3331)],
  [((80 : ℚ) / 3683), (((-1083) : ℚ) / 7796), (((-777) : ℚ) / 7123), (((-1171) : ℚ) / 8649), ((277 : ℚ) / 6003), ((1311 : ℚ) / 9257), ((441 : ℚ) / 4913), (((-826) : ℚ) / 9301), ((127 : ℚ) / 3104), (((-12) : ℚ) / 1859), ((964 : ℚ) / 4703), ((541 : ℚ) / 9533), (((-439) : ℚ) / 4610), (((-31) : ℚ) / 8503), (((-363) : ℚ) / 4886), ((1127 : ℚ) / 8672), (((-797) : ℚ) / 6331), (((-285) : ℚ) / 2416), (((-192) : ℚ) / 2237), (((-805) : ℚ) / 8018), (((-113) : ℚ) / 1646), (((-748) : ℚ) / 4907), (((-515) : ℚ) / 3369), ((425 : ℚ) / 4874), ((644 : ℚ) / 8019), ((1588 : ℚ) / 9655), ((1488 : ℚ) / 8869), (((-1362) : ℚ) / 9223), (((-1043) : ℚ) / 9014), ((1373 : ℚ) / 9505), (((-855) : ℚ) / 9727), ((677 : ℚ) / 4992)],
  [((145 : ℚ) / 3898), (((-553) : ℚ) / 8108), (((-364) : ℚ) / 1867), ((167 : ℚ) / 1440), (((-872) : ℚ) / 7311), ((265 : ℚ) / 8059), ((659 : ℚ) / 4368), (((-1253) : ℚ) / 9578), ((1091 : ℚ) / 9629), (((-1431) : ℚ) / 7745), ((9 : ℚ) / 392), ((817 : ℚ) / 9853), ((63 : ℚ) / 6082), (((-391) : ℚ) / 2908), (((-59) : ℚ) / 595), (((-871) : ℚ) / 7574), ((111 : ℚ) / 1510), ((400 : ℚ) / 3929), ((1423 : ℚ) / 7195), (((-492) : ℚ) / 3955), ((81 : ℚ) / 1054), (((-54) : ℚ) / 991), (((-1085) : ℚ) / 8311), ((470 : ℚ) / 6819), (((-443) : ℚ) / 7698), ((1102 : ℚ) / 8867), ((683 : ℚ) / 3574), ((1 : ℚ) / 161), (((-1211) : ℚ) / 7102), (((-229) : ℚ) / 9251), (((-43) : ℚ) / 7305), (((-119) : ℚ) / 7808)],
  [((217 : ℚ) / 7855), (((-358) : ℚ) / 4659), (((-3) : ℚ) / 98), (((-93) : ℚ) / 752), ((1333 : ℚ) / 8963), ((738 : ℚ) / 8809), (((-304) : ℚ) / 3993), ((662 : ℚ) / 5807), ((541 : ℚ) / 8777), ((1203 : ℚ) / 9097), ((1849 : ℚ) / 9960), ((1167 : ℚ) / 7537), ((472 : ℚ) / 6881), (((-271) : ℚ) / 2940), (((-1645) : ℚ) / 9578), (((-1265) : ℚ) / 8509), ((986 : ℚ) / 8519), (((-306) : ℚ) / 2605), (((-107) : ℚ) / 2625), (((-27) : ℚ) / 5755), (((-402) : ℚ) / 9725), ((153 : ℚ) / 2527), (((-1231) : ℚ) / 9894), (((-448) : ℚ) / 7423), (((-1163) : ℚ) / 6418), (((-1183) : ℚ) / 6697), ((259 : ℚ) / 3694), ((20 : ℚ) / 433), ((885 : ℚ) / 8752), ((683 : ℚ) / 4855), (((-1619) : ℚ) / 9899), ((337 : ℚ) / 4439)],
  [(((-5) : ℚ) / 44), ((533 : ℚ) / 6060), ((313 : ℚ) / 5848), ((669 : ℚ) / 8410), ((331 : ℚ) / 4468), (((-170) : ℚ) / 1057), ((695 : ℚ) / 9937), (((-235) : ℚ) / 7322), (((-1317) : ℚ) / 7142), (((-814) : ℚ) / 6815), ((1097 : ℚ) / 9924), (((-84) : ℚ) / 7831), ((1395 : ℚ) / 9851), ((851 : ℚ) / 9816), ((967 : ℚ) / 9389), (((-2) : ℚ) / 127), (((-559) : ℚ) / 9566), (((-101) : ℚ) / 4177), (((-146) : ℚ) / 5585), ((17 : ℚ) / 2209), (((-359) : ℚ) / 4821), (((-224) : ℚ) / 1179), (((-1243) : ℚ) / 7032), (((-842) : ℚ) / 8341), (((-139) : ℚ) / 8103), ((98 : ℚ) / 6115), (((-864) : ℚ) / 9041), ((258 : ℚ) / 8545), (((-57) : ℚ) / 3272), ((758 : ℚ) / 7587), (((-1248) : ℚ) / 8633), ((421 : ℚ) / 3767)]
]
def teacherBlock2FFNLinear2Bias : List ℚ := [((1321 : ℚ) / 8047), ((1245 : ℚ) / 9256), (((-983) : ℚ) / 9256), ((974 : ℚ) / 6245), (((-2) : ℚ) / 1331), (((-47) : ℚ) / 1602), (((-607) : ℚ) / 7804), ((156 : ℚ) / 5963), ((80 : ℚ) / 7617), ((482 : ℚ) / 9255), (((-85) : ℚ) / 3024), (((-367) : ℚ) / 9183), ((78 : ℚ) / 829), ((729 : ℚ) / 4775), ((63 : ℚ) / 1528), ((913 : ℚ) / 5711)]
def teacherBlock2FFNLinear2 : Layer where
  weights := teacherBlock2FFNLinear2Weights
  bias := teacherBlock2FFNLinear2Bias

/-- FFN Block: 16 → 32 → 16 -/
def teacherBlock2FFN : FFNBlock where
  linear1 := teacherBlock2FFNLinear1
  linear2 := teacherBlock2FFNLinear2
  dims_match := by simp [teacherBlock2FFNLinear1, teacherBlock2FFNLinear2, teacherBlock2FFNLinear1Weights, teacherBlock2FFNLinear2Weights, Layer.inputDim, Layer.outputDim, teacherBlock2FFNLinear1Bias]

/-- Post-FFN LayerNorm -/
def teacherBlock2LN2Gamma : List ℚ := [((5966 : ℚ) / 6115), ((7313 : ℚ) / 7318), ((2285 : ℚ) / 2217), ((5794 : ℚ) / 5983), ((9675 : ℚ) / 9904), ((4039 : ℚ) / 4124), ((9357 : ℚ) / 9521), ((9099 : ℚ) / 9245), ((1365 : ℚ) / 1343), ((8843 : ℚ) / 8805), ((1327 : ℚ) / 1328), ((44 : ℚ) / 45), ((7981 : ℚ) / 8140), ((9019 : ℚ) / 9072), ((8799 : ℚ) / 9197), ((7948 : ℚ) / 8175)]
def teacherBlock2LN2Beta : List ℚ := [((110 : ℚ) / 8521), (((-98) : ℚ) / 7925), (((-115) : ℚ) / 9051), ((89 : ℚ) / 6732), ((108 : ℚ) / 7943), (((-136) : ℚ) / 7473), (((-64) : ℚ) / 4767), (((-125) : ℚ) / 8098), ((95 : ℚ) / 7236), (((-103) : ℚ) / 7569), (((-103) : ℚ) / 8647), ((11 : ℚ) / 810), (((-133) : ℚ) / 9759), (((-69) : ℚ) / 5230), (((-117) : ℚ) / 8812), (((-39) : ℚ) / 2906)]
def teacherBlock2LN2Epsilon : ℚ := ((1 : ℚ) / 100000)
def teacherBlock2LN2 : LayerNormParams where
  gamma := teacherBlock2LN2Gamma
  beta := teacherBlock2LN2Beta
  epsilon := teacherBlock2LN2Epsilon
  epsilon_pos := by simp only [teacherBlock2LN2Epsilon]; norm_num

/-- Transformer Block: dim=16, hidden=32 -/
def teacherBlock2 : TransformerBlock where
  ln1 := teacherBlock2LN1
  ffn := teacherBlock2FFN
  ln2 := teacherBlock2LN2

/-- All transformer blocks -/
def teacherBlocks : List TransformerBlock := [teacherBlock1, teacherBlock2]

/-! ## Input Domain and Verification -/

def mkInterval (lo hi : ℚ) (h : lo ≤ hi := by norm_num) (prec : Int := -53) : IntervalDyadic :=
  IntervalDyadic.ofIntervalRat ⟨lo, hi, h⟩ prec

/-- Input domain -/
def teacherInput : IntervalVector := [mkInterval (-1) 1, mkInterval (-1) 1, mkInterval (-1) 1, mkInterval (-1) 1, mkInterval (-1) 1, mkInterval (-1) 1, mkInterval (-1) 1, mkInterval (-1) 1, mkInterval (-1) 1, mkInterval (-1) 1, mkInterval (-1) 1, mkInterval (-1) 1, mkInterval (-1) 1, mkInterval (-1) 1, mkInterval (-1) 1, mkInterval (-1) 1]

/-- Forward pass with affine arithmetic for tight LayerNorm bounds -/
def teacherForward (x : IntervalVector) (prec : Int := -53) : IntervalVector :=
  teacherBlocks.foldl (fun acc blk => blk.forwardIntervalTight acc prec) x

/-- Computed output bounds -/
def teacherOutputBounds : IntervalVector := teacherForward teacherInput (-53)

#eval teacherOutputBounds.map (fun I => (I.lo.toRat, I.hi.toRat))


/-! ## Student Model -/

open LeanCert.ML
open LeanCert.ML.Transformer
open IntervalVector

/-! ## Layer 1 -/

/-- Pre-FFN LayerNorm -/
def studentBlock1LN1Gamma : List ℚ := [((5475 : ℚ) / 5581), ((7167 : ℚ) / 7244), ((2116 : ℚ) / 2111), ((6881 : ℚ) / 7010), ((6342 : ℚ) / 6319), ((6064 : ℚ) / 6451), ((6181 : ℚ) / 6015), ((9887 : ℚ) / 9587)]
def studentBlock1LN1Beta : List ℚ := [((31 : ℚ) / 9968), (((-172) : ℚ) / 9623), ((295 : ℚ) / 8191), ((33 : ℚ) / 5675), (((-156) : ℚ) / 4393), (((-49) : ℚ) / 1020), ((227 : ℚ) / 5122), (((-58) : ℚ) / 1851)]
def studentBlock1LN1Epsilon : ℚ := ((1 : ℚ) / 100000)
def studentBlock1LN1 : LayerNormParams where
  gamma := studentBlock1LN1Gamma
  beta := studentBlock1LN1Beta
  epsilon := studentBlock1LN1Epsilon
  epsilon_pos := by simp only [studentBlock1LN1Epsilon]; norm_num

/-- Feed-Forward Network -/
def studentBlock1FFNLinear1Weights : List (List ℚ) := [
  [(((-1477) : ℚ) / 8201), (((-485) : ℚ) / 2162), (((-160) : ℚ) / 1749), ((1143 : ℚ) / 5447), ((2481 : ℚ) / 8207), (((-1840) : ℚ) / 9727), ((2228 : ℚ) / 6473), (((-119) : ℚ) / 8784)],
  [(((-520) : ℚ) / 2637), (((-715) : ℚ) / 9539), ((269 : ℚ) / 1363), ((1714 : ℚ) / 6815), ((2706 : ℚ) / 8347), (((-583) : ℚ) / 7393), (((-2657) : ℚ) / 8706), (((-854) : ℚ) / 9287)],
  [((161 : ℚ) / 6500), ((626 : ℚ) / 4899), ((1359 : ℚ) / 3587), (((-266) : ℚ) / 9927), (((-1019) : ℚ) / 2202), (((-1438) : ℚ) / 8443), ((1767 : ℚ) / 7678), ((396 : ℚ) / 2707)],
  [(((-343) : ℚ) / 7617), ((29 : ℚ) / 995), (((-1083) : ℚ) / 9691), (((-699) : ℚ) / 8591), (((-1321) : ℚ) / 5592), (((-1019) : ℚ) / 9409), ((2426 : ℚ) / 9441), (((-769) : ℚ) / 4361)],
  [((29 : ℚ) / 5049), (((-671) : ℚ) / 3112), (((-1581) : ℚ) / 5078), ((1443 : ℚ) / 3970), (((-137) : ℚ) / 6203), (((-1320) : ℚ) / 9991), ((2372 : ℚ) / 8495), (((-117) : ℚ) / 8656)],
  [((96 : ℚ) / 4865), ((19 : ℚ) / 598), (((-2612) : ℚ) / 9381), ((886 : ℚ) / 2969), ((1567 : ℚ) / 4624), (((-987) : ℚ) / 8405), ((22 : ℚ) / 1643), ((483 : ℚ) / 6248)],
  [(((-190) : ℚ) / 563), ((2133 : ℚ) / 9409), ((122 : ℚ) / 1859), ((1814 : ℚ) / 8513), ((1 : ℚ) / 456), (((-739) : ℚ) / 7331), ((2119 : ℚ) / 8558), ((1565 : ℚ) / 7664)],
  [((13 : ℚ) / 8427), (((-86) : ℚ) / 3931), (((-613) : ℚ) / 8734), ((284 : ℚ) / 5289), ((233 : ℚ) / 8802), ((3335 : ℚ) / 8141), ((135 : ℚ) / 7001), (((-1009) : ℚ) / 2180)],
  [(((-753) : ℚ) / 2393), (((-2281) : ℚ) / 7031), ((1379 : ℚ) / 6764), (((-1599) : ℚ) / 5698), ((396 : ℚ) / 4049), (((-1239) : ℚ) / 7624), (((-1997) : ℚ) / 9653), (((-2737) : ℚ) / 7782)],
  [(((-1505) : ℚ) / 8583), ((1495 : ℚ) / 6763), (((-623) : ℚ) / 8791), ((1754 : ℚ) / 8149), (((-2909) : ℚ) / 8623), ((1625 : ℚ) / 7758), (((-1077) : ℚ) / 6836), (((-908) : ℚ) / 8747)],
  [((217 : ℚ) / 1978), ((101 : ℚ) / 380), (((-2008) : ℚ) / 7621), (((-3221) : ℚ) / 9493), ((4312 : ℚ) / 9245), ((2191 : ℚ) / 9236), (((-1513) : ℚ) / 6389), (((-1903) : ℚ) / 9522)],
  [(((-657) : ℚ) / 8146), (((-2237) : ℚ) / 9763), ((1046 : ℚ) / 7007), (((-1768) : ℚ) / 9965), (((-496) : ℚ) / 1691), ((5 : ℚ) / 8107), ((858 : ℚ) / 8863), ((1042 : ℚ) / 8369)],
  [(((-663) : ℚ) / 5266), ((2208 : ℚ) / 7565), (((-33) : ℚ) / 3989), (((-1474) : ℚ) / 4453), (((-67) : ℚ) / 3281), (((-2287) : ℚ) / 7901), ((800 : ℚ) / 6657), ((355 : ℚ) / 2009)],
  [((2187 : ℚ) / 8578), ((857 : ℚ) / 7442), ((2977 : ℚ) / 9916), (((-234) : ℚ) / 5959), (((-74) : ℚ) / 9633), ((213 : ℚ) / 8866), ((3311 : ℚ) / 9355), (((-1140) : ℚ) / 4091)],
  [((1849 : ℚ) / 8773), ((2089 : ℚ) / 8926), ((777 : ℚ) / 6539), ((1895 : ℚ) / 9426), ((133 : ℚ) / 1658), (((-996) : ℚ) / 8003), (((-2104) : ℚ) / 9609), (((-845) : ℚ) / 6746)],
  [((1041 : ℚ) / 5216), (((-521) : ℚ) / 9406), ((1419 : ℚ) / 9016), ((227 : ℚ) / 607), ((1904 : ℚ) / 6775), (((-209) : ℚ) / 9092), ((806 : ℚ) / 2393), (((-207) : ℚ) / 1498)]
]
def studentBlock1FFNLinear1Bias : List ℚ := [(((-2365) : ℚ) / 9668), (((-75) : ℚ) / 9872), ((271 : ℚ) / 6471), ((2369 : ℚ) / 9677), (((-1813) : ℚ) / 8019), ((240 : ℚ) / 4027), ((1762 : ℚ) / 5905), (((-1257) : ℚ) / 6424), (((-378) : ℚ) / 2507), ((2925 : ℚ) / 8402), (((-221) : ℚ) / 4032), ((23 : ℚ) / 3425), (((-1597) : ℚ) / 7513), ((423 : ℚ) / 9139), (((-1111) : ℚ) / 5904), (((-459) : ℚ) / 6010)]
def studentBlock1FFNLinear1 : Layer where
  weights := studentBlock1FFNLinear1Weights
  bias := studentBlock1FFNLinear1Bias

def studentBlock1FFNLinear2Weights : List (List ℚ) := [
  [(((-295) : ℚ) / 9932), (((-231) : ℚ) / 9826), (((-1867) : ℚ) / 9727), ((522 : ℚ) / 8807), ((3 : ℚ) / 14), (((-91) : ℚ) / 1436), ((4 : ℚ) / 1985), (((-1859) : ℚ) / 9440), (((-8) : ℚ) / 785), ((38 : ℚ) / 191), (((-213) : ℚ) / 7309), ((411 : ℚ) / 5093), (((-1347) : ℚ) / 8219), (((-238) : ℚ) / 2923), (((-274) : ℚ) / 3121), (((-339) : ℚ) / 6581)],
  [(((-167) : ℚ) / 9676), (((-246) : ℚ) / 5593), ((37 : ℚ) / 2245), ((5 : ℚ) / 9469), (((-1195) : ℚ) / 5216), ((1245 : ℚ) / 9832), (((-687) : ℚ) / 6131), ((199 : ℚ) / 8681), ((83 : ℚ) / 8164), (((-1228) : ℚ) / 7933), ((324 : ℚ) / 6901), (((-2040) : ℚ) / 8327), (((-5) : ℚ) / 4502), ((343 : ℚ) / 7675), ((307 : ℚ) / 1816), (((-1219) : ℚ) / 9158)],
  [(((-582) : ℚ) / 2489), (((-2208) : ℚ) / 9859), (((-903) : ℚ) / 7388), ((58 : ℚ) / 401), ((70 : ℚ) / 9329), (((-243) : ℚ) / 8707), (((-49) : ℚ) / 8441), (((-138) : ℚ) / 1405), ((179 : ℚ) / 2579), ((57 : ℚ) / 3316), ((226 : ℚ) / 1807), (((-1645) : ℚ) / 9971), (((-1089) : ℚ) / 5477), (((-1937) : ℚ) / 9626), ((25 : ℚ) / 4818), ((101 : ℚ) / 9935)],
  [((339 : ℚ) / 8423), ((209 : ℚ) / 6965), ((1019 : ℚ) / 4088), ((419 : ℚ) / 1792), ((1901 : ℚ) / 8614), (((-906) : ℚ) / 5069), ((220 : ℚ) / 9443), ((173 : ℚ) / 7711), ((695 : ℚ) / 4223), ((569 : ℚ) / 2768), (((-202) : ℚ) / 1273), ((69 : ℚ) / 1532), (((-677) : ℚ) / 5651), (((-207) : ℚ) / 4792), (((-1193) : ℚ) / 7033), (((-21) : ℚ) / 9292)],
  [(((-236) : ℚ) / 3427), (((-682) : ℚ) / 9091), ((1135 : ℚ) / 9068), ((661 : ℚ) / 5219), (((-1762) : ℚ) / 8373), ((256 : ℚ) / 5701), (((-1711) : ℚ) / 9774), ((2399 : ℚ) / 8783), (((-1645) : ℚ) / 8599), ((37 : ℚ) / 2993), (((-2034) : ℚ) / 8083), ((578 : ℚ) / 6577), ((2218 : ℚ) / 8937), ((1791 : ℚ) / 9544), (((-99) : ℚ) / 2803), (((-1141) : ℚ) / 7111)],
  [(((-343) : ℚ) / 3124), (((-1109) : ℚ) / 7882), (((-979) : ℚ) / 4955), (((-383) : ℚ) / 7657), (((-480) : ℚ) / 7541), ((333 : ℚ) / 8906), (((-783) : ℚ) / 5932), (((-1367) : ℚ) / 6167), (((-1706) : ℚ) / 7785), ((1924 : ℚ) / 8823), (((-717) : ℚ) / 4462), ((1328 : ℚ) / 9691), ((641 : ℚ) / 3026), ((1448 : ℚ) / 8889), ((276 : ℚ) / 6263), (((-1889) : ℚ) / 7928)],
  [(((-51) : ℚ) / 4813), ((180 : ℚ) / 1747), (((-1651) : ℚ) / 8882), ((13 : ℚ) / 9069), (((-998) : ℚ) / 9993), (((-1007) : ℚ) / 6740), ((1136 : ℚ) / 9459), ((578 : ℚ) / 3821), ((1564 : ℚ) / 7547), (((-189) : ℚ) / 965), ((1715 : ℚ) / 9046), (((-511) : ℚ) / 9964), ((137 : ℚ) / 5779), ((246 : ℚ) / 6641), ((1036 : ℚ) / 9859), ((323 : ℚ) / 6808)],
  [(((-267) : ℚ) / 6364), ((803 : ℚ) / 8336), (((-992) : ℚ) / 8279), ((266 : ℚ) / 3281), (((-952) : ℚ) / 3777), ((181 : ℚ) / 5548), (((-423) : ℚ) / 5473), ((2115 : ℚ) / 9941), ((339 : ℚ) / 4729), ((1077 : ℚ) / 6932), (((-249) : ℚ) / 5495), ((917 : ℚ) / 9985), ((1403 : ℚ) / 5849), (((-1576) : ℚ) / 4913), ((771 : ℚ) / 8384), (((-1342) : ℚ) / 7353)]
]
def studentBlock1FFNLinear2Bias : List ℚ := [(((-484) : ℚ) / 7273), ((767 : ℚ) / 5738), ((454 : ℚ) / 3307), ((1127 : ℚ) / 8748), ((649 : ℚ) / 2935), ((1117 : ℚ) / 5451), (((-1001) : ℚ) / 9497), (((-2254) : ℚ) / 8971)]
def studentBlock1FFNLinear2 : Layer where
  weights := studentBlock1FFNLinear2Weights
  bias := studentBlock1FFNLinear2Bias

/-- FFN Block: 8 → 16 → 8 -/
def studentBlock1FFN : FFNBlock where
  linear1 := studentBlock1FFNLinear1
  linear2 := studentBlock1FFNLinear2
  dims_match := by simp [studentBlock1FFNLinear1, studentBlock1FFNLinear2, studentBlock1FFNLinear1Weights, studentBlock1FFNLinear2Weights, Layer.inputDim, Layer.outputDim, studentBlock1FFNLinear1Bias]

/-- Post-FFN LayerNorm -/
def studentBlock1LN2Gamma : List ℚ := [((7123 : ℚ) / 6972), ((10071 : ℚ) / 9400), ((8129 : ℚ) / 8332), ((7713 : ℚ) / 7634), ((6607 : ℚ) / 6704), ((2629 : ℚ) / 2471), ((9697 : ℚ) / 9792), ((3082 : ℚ) / 3157)]
def studentBlock1LN2Beta : List ℚ := [((49 : ℚ) / 1691), (((-311) : ℚ) / 9629), (((-245) : ℚ) / 8612), ((274 : ℚ) / 9079), ((229 : ℚ) / 8510), ((249 : ℚ) / 7858), ((3 : ℚ) / 104), ((215 : ℚ) / 8849)]
def studentBlock1LN2Epsilon : ℚ := ((1 : ℚ) / 100000)
def studentBlock1LN2 : LayerNormParams where
  gamma := studentBlock1LN2Gamma
  beta := studentBlock1LN2Beta
  epsilon := studentBlock1LN2Epsilon
  epsilon_pos := by simp only [studentBlock1LN2Epsilon]; norm_num

/-- Transformer Block: dim=8, hidden=16 -/
def studentBlock1 : TransformerBlock where
  ln1 := studentBlock1LN1
  ffn := studentBlock1FFN
  ln2 := studentBlock1LN2

/-- All transformer blocks -/
def studentBlocks : List TransformerBlock := [studentBlock1]

/-! ## Input Domain and Verification -/

def mkInterval (lo hi : ℚ) (h : lo ≤ hi := by norm_num) (prec : Int := -53) : IntervalDyadic :=
  IntervalDyadic.ofIntervalRat ⟨lo, hi, h⟩ prec

/-- Input domain -/
def studentInput : IntervalVector := [mkInterval (-1) 1, mkInterval (-1) 1, mkInterval (-1) 1, mkInterval (-1) 1, mkInterval (-1) 1, mkInterval (-1) 1, mkInterval (-1) 1, mkInterval (-1) 1]

/-- Forward pass with affine arithmetic for tight LayerNorm bounds -/
def studentForward (x : IntervalVector) (prec : Int := -53) : IntervalVector :=
  studentBlocks.foldl (fun acc blk => blk.forwardIntervalTight acc prec) x

/-- Computed output bounds -/
def studentOutputBounds : IntervalVector := studentForward studentInput (-53)

#eval studentOutputBounds.map (fun I => (I.lo.toRat, I.hi.toRat))


/-! ## Comparison -/

/-- Compare output bounds between teacher and student -/
#eval do
  IO.println "======================================"
  IO.println "Teacher vs Student Output Bounds"
  IO.println "======================================"
  IO.println ""
  IO.println "Teacher output bounds:"
  for h : i in [:teacherOutputBounds.length] do
    let I := teacherOutputBounds[i]
    IO.println s!"  output[{i}] ∈ [{I.lo.toRat}, {I.hi.toRat}]"
    IO.println s!"    width = {I.hi.toRat - I.lo.toRat}"
  IO.println ""
  IO.println "Student output bounds:"
  for h : i in [:studentOutputBounds.length] do
    let I := studentOutputBounds[i]
    IO.println s!"  output[{i}] ∈ [{I.lo.toRat}, {I.hi.toRat}]"
    IO.println s!"    width = {I.hi.toRat - I.lo.toRat}"
  IO.println ""
  IO.println "======================================"

end DistillationTest
